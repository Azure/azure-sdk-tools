{"testcase": "How to restrict importing typespec files in main based off of versions.", "query": "title: How to restrict importing typespec files in main based off of versions.\n\nquestion: Hi Team,\nWe have 2 imports in our main.tsp to include other resource type tsp files, however we do not want to include one of the resourcetype to the new api version we want to introduce.  Is there a way to do conditional imports based off of version in main?\nThank you in advance!", "ground_truth": "no, you have to mark the models/types and everything that you want to remove with the @removed decorator using the versioning library\nif you are in preview version I think also the policy is to only have a single preview version in the spec repo at the timme now so you could also just delete it", "expected_knowledges": [{"title": "How to restrict importing typespec files in main based off of versions. | question", "link": ""}, {"title": "Usages for Illustrates conditional request headers | Full Sample:", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/special-headers/conditional-request/main.tsp"}, {"title": "Usages for Illustrates not-discriminated inheritance model. | Full Sample:", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/type/model/inheritance/not-discriminated/main.tsp"}, {"title": "Migrate data-plane specs | Initial pass through checklist", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/checklists/migrate-dp-tips"}, {"title": "bad | `TypeSpec Requirement` check", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "6. Complete Example and Generate OpenApi 2.0 spec | A Complete Example", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-resource-manager/step05"}, {"title": "Usages for Supported api versions. | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/client-generator-core/api-version/path/main.tsp"}, {"title": "Creating stable API version with select properties omitted? | answer", "link": ""}, {"title": "Usages for ServerPathMultiple | Full Sample:", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/server/path/multiple/main.tsp"}, {"title": "Usages for Illustrates Azure Core operation customizations by traits | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/core/traits/main.tsp"}, {"title": "Imports", "link": "https://typespec.io/docs/language-basics/imports"}, {"title": "Usages for Supported api versions. | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/client-generator-core/api-version/header/main.tsp"}, {"title": "Usages for Arm Resource Provider management API. | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/resource-manager/large-header/main.tsp"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Creating stable API version with select properties omitted? | answer", "link": ""}, {"title": "Usages for Test for ARM method level subscription ID parameter placement | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/resource-manager/method-subscription-id/main.tsp"}, {"title": "Azure REST API Specification Directory Structure | Service folder structure | Contents of a service folder", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Specification-Folder-Structure-Guide"}, {"title": "Usages for Supported api versions. | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/client-generator-core/api-version/query/main.tsp"}, {"title": "Usages for Illustrates bodies templated with Azure Core with long-running RPC operation | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/core/lro/rpc/main.tsp"}, {"title": "Frequently Asked Questions | File Layout for ARM Services", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/frequentquestions"}, {"title": "Usage | Important concepts | Per project setup", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-with-tsp-client/intro_tsp_client"}, {"title": "Decorators | Azure.ClientGenerator.Core | `@clientApiVersions` {#@Azure.ClientGenerator.Core.clientApiVersions}", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/reference/decorators"}, {"title": "Installation | Create a new TypeSpec project", "link": "https://typespec.io/docs/introduction/installation"}, {"title": "Versioning | Introduction to the `@versioned` Decorator | Generating OpenAPI Specifications for Different Versions", "link": "https://typespec.io/docs/getting-started/getting-started-rest/06-versioning"}, {"title": "Release new api version process with TypeSpec | answer", "link": ""}, {"title": "Decorators | Azure.ClientGenerator.Core | `@apiVersion` {#@Azure.ClientGenerator.Core.apiVersion}", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/reference/decorators"}, {"title": "or specific areas | `imports` - Configure additional imports", "link": "https://typespec.io/docs/handbook/configuration/configuration"}, {"title": "Handling multiple API versions using typespec | answer", "link": ""}, {"title": "9. Versioning | Versioning your service", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-core/step09"}], "expected_references": [{"title": "How to restrict importing typespec files in main based off of versions. | question", "link": ""}]}
{"testcase": "Description changes across versions?", "query": "title: Description changes across versions?\n\nquestion: Hi, as part of this PR: [Service Fabric Managed Clusters - API version 2025-03-01-preview · Azure/azure-rest-api-specs@599e269](https://github.com/Azure/azure-rest-api-specs/actions/runs/14090043123/job/39464153437?pr=33332)\nMy team wanted to add more details to a model description. This change results in a change in all spec versions generated with Typespec, and causes the Typespec validation to fail if I don't include the changes to the older specs.\nI wanted to know what the best course of action was for passing this check. Since we don't expect updates to our older specs, is it ok to just change the output path in our tspconfig.yaml to only point at the current version of the output spec? Or is there a better way to handle this?", "ground_truth": "Honestly, the best thing is to update your docs and take the update in previous versions (which are likely now more accurately described as well). Documentation updates are not breaking changes, and, if changes are limited to documentation, this should be passed easily by the breaking change board.", "expected_knowledges": [{"title": "Description changes across versions? | question", "link": ""}, {"title": "How to change the model to accommodate new decorators for validations | answer", "link": ""}, {"title": "Reproducibility", "link": "https://typespec.io/docs/handbook/reproducibility"}, {"title": "Tutorial | Versioning APIs", "link": "https://typespec.io/docs/libraries/versioning/guide"}, {"title": "Adding a Preview Version when the Last Version was Preview | The General Case: One or more Stable Versions Exist | Making Changes to your TypeSpec spec", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/02-preview-after-preview"}, {"title": "TypeSpec: How can I change only descriptions/comments between versions while keeping models identical? | question", "link": ""}, {"title": "Adding a Preview Version when the Last Version was Stable | Making Changes to your TypeSpec spec", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/04-preview-after-stable"}, {"title": "Versioning | Introduction to the `@versioned` Decorator | Generating OpenAPI Specifications for Different Versions", "link": "https://typespec.io/docs/getting-started/getting-started-rest/06-versioning"}, {"title": "Versioning", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/01-about-versioning"}, {"title": "Known Issues | MULTIPLE_API_VERSION", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado"}, {"title": "The number of enums in the old and new Swagger don't match | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Convert OpenAPI specs to TypeSpec | Conversion scope", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "Adding a Preview Version when the Last Version was Preview", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/02-preview-after-preview"}, {"title": "How to Manage a Single Active Preview When Some Features Always Remain In Preview", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/02-perpetual-preview"}, {"title": "Usages for Test that we can grow up a service spec and service deployment into a multi-versioned service with full client support. | Scenario: Expanding optional parameters in an operation over versions", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/resiliency/srv-driven/main.tsp"}, {"title": "Breaking Change Policy | Categories of Breaking Changes", "link": "https://typespec.io/docs/handbook/breaking-change-policy"}, {"title": "Azure Versioning and Breaking Changes Policy V1.3.2 | 1. Policy Overview and Motivation | 1.1 Motivation", "link": ""}, {"title": "Duplicate model definition errors on compilation with TypeSpec Compiler v1.0.0 - Microsoft.Mission | question", "link": ""}, {"title": "How to change the model to accommodate new decorators for validations | answer", "link": ""}, {"title": "Generating readme and examples files | answer", "link": ""}, {"title": "Validation Rule Suppression | Suppressing SdkTspConfigValidation Rules | Suppress Specific Sub-rules within SdkTspConfigValidation", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Validation"}, {"title": "Handling multiple API versions using typespec | answer", "link": ""}, {"title": "How to update any model without affecting old API versions | answer", "link": ""}, {"title": "TypeSpec: How can I change only descriptions/comments between versions while keeping models identical? | question", "link": ""}, {"title": "Process", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Deprecating-Preview-APIs"}, {"title": "TypeSpec AutoRest Library | Configuration | Emitter options:", "link": "https://azure.github.io/typespec-azure/docs/emitters/typespec-autorest/index"}], "expected_references": [{"title": "Description changes across versions? | question", "link": ""}, {"title": "TypeSpec: How can I change only descriptions/comments between versions while keeping models identical? | question", "link": ""}]}
{"testcase": "Quantum RP, add new filter to offering API", "query": "title: Quantum RP, add new filter to offering API\n\nquestion: Hi team,\n[Quantum [dev]: Add kind (v1/v2) to workspace by 04diiguyi · Pull Request #25310 · Azure/azure-rest-…](https://github.com/Azure/azure-rest-api-specs-pr/pull/25310/commits/e400cd4c150910e6e4837cda4be0ef51bec7b496)\nThe existing function is:\nlistBySubscription is ArmListBySubscription<QuantumSuiteOffer>;\nNow our service supports filter, so I would like to change it to:\n```\nlistBySubscription is ArmListBySubscription<\nQuantumSuiteOffer,\nParameters = {\n/**\n* The filter to apply to the operation. Example: '$filter=kind eq 'v1'\n*/\n@query(\"$filter\")\n$filter?: string;\n}\n>;\n```\nHowever, the versioning breaks. It does not work if I change to:\n```\n@removed(Versions.v2025_11_01_preview)\nlistBySubscription is ArmListBySubscription<QuantumSuiteOffer>;\n@added(Versions.v2025_11_01_preview)\nlistBySubscription is ArmListBySubscription<\nQuantumSuiteOffer,\nParameters = {\n/**\n* The filter to apply to the operation. Example: '$filter=kind eq 'v1'\n*/\n@query(\"$filter\")\n$filter?: string;\n}\n>;\n```\nOr\n```\n@removed(Versions.v2025_11_01_preview)\nlistBySubscription is ArmListBySubscription<QuantumSuiteOffer>;\n@added(Versions.v2025_11_01_preview)\nlistBySubscriptionV2 is ArmListBySubscription<\nQuantumSuiteOffer,\nParameters = {\n/**\n* The filter to apply to the operation. Example: '$filter=kind eq 'v1'\n*/\n@query(\"$filter\")\n$filter?: string;\n}\n>;\n```\nCould anyone provide suggestions how I can fix this issue? Thanks", "ground_truth": "For a case like this, just decorating the filter property with `@added` in the same operation is the simplest mechanism.  Versioning the request and response data in an operation like this is usually the most straightforward way to version an operation.\nFor more complex operation versioning, you can use the remove/rename/sharedRoute mechanism described here: [Versioning | TypeSpec Azure](https://azure.github.io/typespec-azure/docs/howtos/arm/versioning/#converting-an-operation-from-synchronous-to-asynchronous)\nNote also that you should name the property 'filter', the `@query(\"$filter\")` decorator actually sets the name on the wire,  you generally want to follow standard naming rules for parameters:\n```\n// v2 (new preview)\nlistBySubscription is ArmListBySubscription<\nQuantumSuiteOffer,\nParameters = {\n/**\n* The filter to apply to the operation. Example: '$filter=kind eq \"v1\"'\n*/\n@added(Versions.v2025_11_01_preview)\n@query(\"$filter\")\nfilter?: string;\n}\n>;\n```", "expected_knowledges": [{"title": "ARM Resource Operations | TypeSpec Operation Templates and Interface Templates | Resource List Operations (GET)", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/resource-operations"}, {"title": "Common API Details | Request Query Parameters ##", "link": "https://github.com/cloud-and-ai-microsoft/resource-provider-contract/blob/master/v1.0/common-api-details.md"}, {"title": "Versioning | Simple Scenarios | Adding a Parameter to an Operation and Making Another Parameter Optional", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "TypeSpec ARM Interface Mapping to Swagger Documentation | 16. ResourceListBySubscription | Swagger Output", "link": ""}, {"title": "Interfaces and Operations | Azure.ResourceManager | `ResourceListBySubscription` {#Azure.ResourceManager.ResourceListBySubscription}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}, {"title": "TypeSpec ARM Operation Mapping to Swagger Documentation | 3. ArmListBySubscription | Swagger Output", "link": ""}, {"title": "Interfaces and Operations | Azure.ResourceManager | `TrackedResourceOperations` {#Azure.ResourceManager.TrackedResourceOperations}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}, {"title": "TypeSpec Azure.ResourceManager.Legacy Operations Mapping to Swagger Documentation | 2. ArmListSinglePageBySubscription | Swagger Output", "link": ""}, {"title": "3. Defining the Resources | 3. **Define an interface with operations for the resource type**", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-resource-manager/step02"}, {"title": "Exclude property from list that is in create/update/get | answer", "link": ""}, {"title": "Cheat sheet | Data types", "link": "https://typespec.io/docs/libraries/http/cheat-sheet"}, {"title": "Subscription Lifecycle API Reference | Creating or Updating a Subscription | Subscription States", "link": "https://github.com/cloud-and-ai-microsoft/resource-provider-contract/blob/master/v1.0/subscription-lifecycle-api-reference.md"}, {"title": "Uri format and arguments for CRUD APIs on resources # | Overview ## | Uri format ###", "link": "https://github.com/cloud-and-ai-microsoft/resource-provider-contract/blob/master/v1.0/uri-format-and-arguments-for-crud-apis-on-resources.md"}, {"title": "Azure Service Versioning Guide | Splitting a Monolithic SDK Package into Service-Specific Packages", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Azure-Service-Versioning-Guideline"}, {"title": "6. Complete Example and Generate OpenApi 2.0 spec | A Complete Example", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-resource-manager/step05"}, {"title": "Usages for Test for ARM method level subscription ID parameter placement | Scenario: Resource PUT operation for SubscriptionResource1 with method-level subscriptionId.", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/resource-manager/method-subscription-id/main.tsp"}, {"title": "Azure Service Versioning Guide | An Azure Resource Provider and its 1+ Azure Services", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Azure-Service-Versioning-Guideline"}, {"title": "Usages for Test for ARM method level subscription ID parameter placement | Scenario: Resource PUT operation for subscription-scoped resource with method-level subscriptionId in mixed scenario.", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/resource-manager/method-subscription-id/main.tsp"}, {"title": "Usages for Test for ARM method level subscription ID parameter placement | Scenario: Resource GET operation for SubscriptionResource1 with method-level subscriptionId.", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/resource-manager/method-subscription-id/main.tsp"}, {"title": "Troubleshooting details | Suppression change without triggering `Suppression Review Required`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Summarize-Impact"}, {"title": "Versioning the LRO headers | answer", "link": ""}, {"title": "Adding a Preview Version when the Last Version was Stable", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/04-preview-after-stable"}, {"title": "Versioning | Versioning Decorators | @removed", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Converting Existing Specs to Single Active Preview | `@added(T, u)` decorator", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}, {"title": "Versioning | Introduction to the `@versioned` Decorator | Example: Defining API Versions", "link": "https://typespec.io/docs/getting-started/getting-started-rest/06-versioning"}, {"title": "Handling multiple API versions using typespec | answer", "link": ""}, {"title": "Migrate ARM spec | Initial pass through checklist", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/checklists/migrate-arm-tips"}, {"title": "Resolving OpenAPI Breaking Change Violations | Migrating ARM Specifications | Customizing Request Payload Parameter Names", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Converting Existing Specs to Single Active Preview | Normalizing Version Decoration (optional)", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}, {"title": "Converting Existing Specs to Single Active Preview | Normalizing Version Decoration (optional)", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}], "expected_references": [{"title": "Versioning | Simple Scenarios | Adding a Parameter to an Operation and Making Another Parameter Optional", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Handling multiple API versions using typespec | answer", "link": ""}]}
{"testcase": "Swagger generation fails due to duplicate operations in interface irrespective of different models.", "query": "title: Swagger generation fails due to duplicate operations in interface irrespective of different models.\n\nquestion: Hi,\nWe’re trying to add a new API version with different property settings, but generating the Swagger keeps failing with the following error for all operations in the interface.\nIn our `policy.tsp` file, we have a model `LeafCertificateConfiguration` where the property `validityPeriodInDays` has a maximum value of 30 for API version `2025-08-01-preview`. For the new version `2025-11-01-preview`, this needs to be updated to a maximum value of 90.\nI used `@renamedFrom`, which worked initially, but it required changes to the root models to use the same annotation. This ended up updating the `armResourceOperations` interface.\nTypeSpec is treating this as a duplicate operation, even though it uses a different model.\nCould anyone please help with this?\nLinking draft PR: [Am/private.device registry 2025 11 01 preview by amathamsetty · Pull Request #25221 · Azure/azure-r…](https://github.com/Azure/azure-rest-api-specs-pr/pull/25221/files#diff-a5db74a835313381d2df910fad2d6293fa3bdcbb5273630a4d9615f0b270058a)\n```\nError: interface.specification/iotworkspaces/DeviceRegistry.Management/policy.tsp:161:3 - error @typespec/http/duplicate-operation: Duplicate operation \"getV1\" routed at \"get /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Private.DeviceRegistry/namespaces/{namespaceName}/credentials/default/policies/{policyName}\".\n> 161 |   getV1 is ArmResourceRead<PolicyV1>;\n```", "ground_truth": "To update the maximum value of `validityPeriodInDays` from 30 to 90 for only the new API version (`2025-11-01-preview`) in your TypeSpec definition, you must use TypeSpec's versioning patterns for breaking model changes. However, TypeSpec currently does not support versioning decorators on decorator arguments (like changing the `@maxValue` parameter per version). Directly updating the decorator value would affect all versions.\nThe correct Azure-compliant pattern is:\nCreate a new property (with a different internal name) for the updated constraint.\nUse `@removed` and `@renamedFrom` on the old property, and `@added` on the new property, both on the same model. This allows you to apply different constraints in different API versions without affecting other versions or causing duplicate operation errors.\nIf the operation signature/model type is changed for only the new version, use the add/remove/rename pattern and use `@sharedRoute` on both versions of the operation (see linked examples). This avoids the duplicate operation error and ensures correct OpenAPI emission for each version.\nExample:\n```\nmodel LeafCertificateConfiguration {\n// Old property: max 30 days, removed in new version\n@maxValue(30)\n@removed(Versions.v2025_11_01_preview)\n@renamedFrom(Versions.v2025_11_01_preview, \"validityPeriodInDays\")\nvalidityPeriodInDaysV1: int32;\n// New property: max 90 days, only in new version\n@added(Versions.v2025_11_01_preview)\n@maxValue(90)\nvalidityPeriodInDays: int32;\n}\n```\nIn your operation/interface, you may need to do the same if the operation signature changes. If you want to have different models for different versions but keep the same route, use the `@sharedRoute` decorator and the `@renamedFrom` pattern for the operation as well (see the \"Converting an Operation from Synchronous to Asynchronous\" example in the docs).\nThis pattern will:\nPrevent duplicate operation errors (since each operation/model is only present in one version)\nEmit the correct schema per version\nNot require changing the operation name at the API surface (the renaming is internal)\nSummary:\nUse the add/remove/rename pattern for versioned property changes that affect validation/constraints.\nUse `@sharedRoute` and `@renamedFrom` for operations if the operation signature changes with the model.\nDo NOT update decorator arguments directly for just one version—they affect all versions.", "expected_knowledges": [{"title": "fix error type for `Operations` interface | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "error duplicate-property in @azure-tools/typespec-azure-resource-manager/lib tsp | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Diagnostics | duplicate-type-name", "link": "https://typespec.io/docs/emitters/openapi3/diagnostics"}, {"title": "Missing \"externalDocs\" | question", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Duplicate Body Error When Instantiating `ProxyResourceOperations`", "link": "https://azure.github.io/typespec-azure/docs/troubleshoot/arm-proxy-operations-error"}, {"title": "Diagnostics | union-unsupported", "link": "https://typespec.io/docs/emitters/openapi3/diagnostics"}, {"title": "SDK generation configuration", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-spec-gen-sdk-config"}, {"title": "operation-missing-api-version", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/operation-missing-api-version"}, {"title": "TypeSpec | `AvoidAnonymousTypes` | `LongRunningResourceAction`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Uniform Versioning Violation Guide | CI Validation", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Uniform-Versioning-Violation-Guide"}, {"title": "bad | Troubleshooting AutoRest suppressions not working | Ensure you are suppressing the right tag (API version)", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "Versioning | Adding New Operations", "link": "https://azure.github.io/typespec-azure/docs/getstarted/versioning"}, {"title": "TypeSpec | `EvenSegmentedPathForPutOperation`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Running Locally", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Versioning | Adding a Property or Parameter", "link": "https://azure.github.io/typespec-azure/docs/getstarted/versioning"}, {"title": "TypeSpec | `ProvisioningStateMustBeReadOnly`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Adding a Preview Version when the Last Version was Stable", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/04-preview-after-stable"}, {"title": "Troubleshooting REST API documentation | **Swagger ApiDocPreview** build is failing", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-docs-troubleshooting"}, {"title": "Duplicate model definition errors on compilation with TypeSpec Compiler v1.0.0 - Microsoft.Mission | question", "link": ""}, {"title": "Versioning the LRO headers | answer", "link": ""}, {"title": "OpenAPI3 to TypeSpec | Detailed Example for Converting Path Routes to Operations | 3. Convert path routes to operations", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "TypeSpec for OpenAPI Developers | Operation Object | operationId", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "error duplicate-property in @azure-tools/typespec-azure-resource-manager/lib tsp | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Release new api version process with TypeSpec | answer", "link": ""}, {"title": "TypeSpec", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Versioning | Versioning Decorators | @renamedFrom", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Duplicate Body Error When Instantiating `ProxyResourceOperations`", "link": "https://azure.github.io/typespec-azure/docs/troubleshoot/arm-proxy-operations-error"}], "expected_references": [{"title": "Versioning | Adding a Property or Parameter", "link": "https://azure.github.io/typespec-azure/docs/getstarted/versioning"}, {"title": "Versioning | Versioning Decorators | @renamedFrom", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Diagnostics | duplicate-type-name", "link": "https://typespec.io/docs/emitters/openapi3/diagnostics"}]}
{"testcase": "Swagger LintDiff - Analyze Code Error", "query": "title: Swagger LintDiff - Analyze Code Error\n\nquestion: I have added a new tsp for the new resource type.\n```\n/** The Connection resource. */\n@added(Versions.v2025_08_01)\n@parentResource(StorageMover)\nmodel Connection\nis Azure.ResourceManager.ProxyResource<ConnectionProperties>\n...ResourceNameParameter<\nResource = Connection,\nKeyName = \"connectionName\",\nSegmentName = \"connections\",\nNamePattern = \"\"\n>;\n}\n```\nThe parent resource StorageMover was already existing as below.\n```\nmodel StorageMover\nis Azure.ResourceManager.TrackedResource<StorageMoverProperties> {\n...ResourceNameParameter<\nResource = StorageMover,\nKeyName = \"storageMoverName\",\nSegmentName = \"storageMovers\",\nNamePattern = \"\"\n>;\n}\n```\nGetting below error for the storageMoverName\n```\n▼ New violations list\nViolation: file:///home/runner/work/azure-rest-api-specs-pr/azure-rest-api-specs-\npr/after/specification/storagemover/resource-manager/Microsoft.StorageMover/stable/2025-08-01/storagemover.json:702\nLevel: error\nCode: ResourceNameRestriction\nMessage: The resource name parameter 'storageMoverName' should be defined with a 'pattern' restriction.\nViolation: file:///home/runner/work/azure-rest-api-specs-pr/azure-rest-api-specs-\npr/after/specification/storagemover/resource-manager/Microsoft.StorageMover/stable/2025-08-01/storagemover.json:751\nLevel: error\nCode: ResourceNameRestriction\nMessage: The resource name parameter 'storageMoverName' should be defined with a 'pattern' restriction.\nViolation: file:///home/runner/work/azure-rest-api-specs-pr/azure-rest-api-specs-\npr/after/specification/storagemover/resource-manager/Microsoft.StorageMover/stable/2025-08-01/storagemover.json:751\n```\n[C2C VPC API changes · Azure/azure-rest-api-specs-pr@82aad52](https://github.com/Azure/azure-rest-api-specs-pr/actions/runs/17603307981/job/50009251049?pr=24362#logs)\nWhen I add the pattern, it also gets applied to older API versions, also it results in it being flagged as a breaking change.\n[C2C VPC API changes · Azure/azure-rest-api-specs-pr@82aad52](https://github.com/Azure/azure-rest-api-specs-pr/actions/runs/17610982295/job/50032651444)\nIs there a way to add the pattern only for a specific API version and newer versions?\nWe assume we should not manually add the pattern to the JSON file generated by `tsp compile`.\nThere is no change in the pattern.\nPR : [C2C VPC API changes by samskan · Pull Request #24362 · Azure/azure-rest-api-specs-pr](https://github.com/Azure/azure-rest-api-specs-pr/pull/24362)", "ground_truth": "You cannot directly version a decorator such as @pattern in TypeSpec; decorators themselves are not versioned. This means that if you update a pattern in your TypeSpec model, it will apply to all API versions emitted by TypeSpec, not just a new version. This is a deliberate design choice to avoid hidden inconsistencies between the declared API surface and the actual backend behavior.\nIf you need different validation patterns (such as a new regex for a resource name) for a specific API version and newer, you have two supported options in TypeSpec:\nIf the new pattern applies to all versions: Update the @pattern decorator in the model directly. This is the common and recommended path if your backend enforces the new pattern for all versions.\nIf the pattern truly differs by API version (rare, and usually discouraged): You must explicitly version the type. For example, you can introduce a new scalar type or model for the new version, and use the @typeChangedFrom or @renamedFrom decorators to describe the transition between versions. This approach requires you to manage versioning logic in TypeSpec, not in the generated OpenAPI/JSON files. You should not edit the generated files by hand, and manual changes to JSON files are not supported.\nHere's a sketch of the pattern versioning approach:\n```\n/** Legacy pattern type for old API versions */\n@pattern(\"^[a-z0-9]{3,18}$\")\nscalar ResourceNameLegacy extends string;\nmodel MyResource {\n@key(\"resourceName\")\n@typeChangedFrom(Versions.v2, ResourceNameLegacy)\n@pattern(\"^[a-zA-Z][a-zA-Z0-9]*(-[a-zA-Z0-9]+)*$\")\nname: string;\n}\n```\nIn this example, TypeSpec will emit the old pattern for older API versions and the new pattern for v2 and above, but you must structure your code accordingly. Note that this approach can lead to more complicated TypeSpec code and is only justified if your backend actually enforces different rules per API version.\nSummary: Do not manually edit JSON files generated by TypeSpec. Use versioning decorators and, if necessary, versioned types to achieve per-version differences. But for most cases, apply the new pattern universally if the service behavior matches. This approach keeps your TypeSpec code clear and maintainable.", "expected_knowledges": [{"title": "bad | Suppress AutoRest extension | Obtain error code", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "remove body for lro | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "TypeSpec | `PatchBodyParameterSchema`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Missing location header in response code leads to pipeline lintdiff error | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Diagnostics | duplicate-type-name", "link": "https://typespec.io/docs/emitters/openapi3/diagnostics"}, {"title": "Fixing Converted TypeSpec | Fixing Linter Rules", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/conversionfix"}, {"title": "Swagger LintDiff Suppression via TypeSpec | answer", "link": ""}, {"title": "remove body for lro | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "We cannot customize the Type for ResourceNameParameter? | answer", "link": ""}, {"title": "Generating readme and examples files | question", "link": ""}, {"title": "TypeSpec | `ResourceNameRestriction`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Adding Scoped Suppressions", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "TypeSpec | `IntegerTypeMustHaveFormat`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "TypeSpec | `AvoidAnonymousTypes` | `LongRunningResourceAction`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "TypeSpec | `AvoidAnonymousParameter` | resource-manager", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "TypeSpec | `AvoidAnonymousParameter` | data-plane", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "TypeSpec | `AvoidAnonymousTypes`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "`ProvisioningStateMustBeReadOnly` lintdiff violation in TypeSpec for ARM Service", "link": "https://azure.github.io/typespec-azure/docs/troubleshoot/status-read-only-error"}, {"title": "bad | Troubleshooting AutoRest suppressions not working | For suppression path, use exactly the element the error is pointing to", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "Usage | Important concepts | Per project setup", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-with-tsp-client/intro_tsp_client"}, {"title": "OpenAPI3 to TypeSpec | Detailed Example for Converting Component Parameters | TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "TypeSpec Azure.ResourceManager.Private.PrivateEndpoints Operations Mapping to Swagger Documentation | 1. CreateOrUpdateAsync | TypeSpec Example", "link": ""}, {"title": "Data types | Azure.ResourceManager | `ResourceNameParameter` {#Azure.ResourceManager.ResourceNameParameter}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "Exclude property from list that is in create/update/get | answer", "link": ""}, {"title": "How to update any model without affecting old API versions | answer", "link": ""}, {"title": "having trouble with examples not matching @pattern rules in github actions | question", "link": ""}, {"title": "How to change the model to accommodate new decorators for validations | question", "link": ""}, {"title": "We cannot customize the Type for ResourceNameParameter? | answer", "link": ""}, {"title": "Creating stable API version with select properties omitted? | answer", "link": ""}], "expected_references": [{"title": "How to update any model without affecting old API versions | answer", "link": ""}, {"title": "How to change the model to accommodate new decorators for validations | question", "link": ""}, {"title": "Data types | Azure.ResourceManager | `ResourceNameParameter`", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}]}
{"testcase": "Versioning the LRO headers", "query": "title: Versioning the LRO headers\n\nquestion: I am reaching out to seek advice about versioning the LRO header:\nMy PR: [Define contract for Batch RuleSet feature by mangoo1 · Pull Request #37879 · Azure/azure-rest-api-s…](https://github.com/Azure/azure-rest-api-specs/pull/37879)\nis about to extend an existing RuleSet PUT endpoint to allow it accepting an optional request body, the feature would be turned on when we specify a bool flag to true and the PUT endpoint would be extend to 201 LRO.\nThis behavior would be available on the new ApiVersion, so I would like to put the Azure.Core.useFinalStateVia annotation to the new ApiVersion, along with LRO/Async headers ArmAsyncOperationHeader<FinalResult = RuleSet> and ArmLroLocationHeader<FinalResult = RuleSet>.  But I still won't be able to find a way to put the @added(version) annotations to them.\nCan I version the operation to achieve this?  [Versioning | TypeSpec](https://typespec.io/docs/getting-started/getting-started-rest/06-versioning/#version-specific-operations)\nWhat would be the recommended way to do this?\n(1.The original put request doesn't have a request body, so I make the put request body optional for backwards compatibility.\n2.There is an optional bool flag in the optional request body to turn the feature requires LRO ON.)", "ground_truth": "here's a [playground](https://azure.github.io/typespec-azure/playground/?options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D&c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwoKdXNpbmcgSHR0cDvHDFJlc3TIDFbpAI7IEkHESi5Db3JlzhJSx1xNxls7CgovKiogQ29udG9zb8RUxR4gUHJvdmlkZXIg5gCDbWVudCBBUEkuICovCkBhcm3IIE5hbWVzcGFjZQpAc2VydmljZSgjeyB0aXRsZTogIsdXyC1IdWJDbGllbnQiIH0pCkDnAUNlZCjnAL9zKQpuyFAgTWljcm9zb2Z0LtJG7wC2QVBJIMdNc%2BQAoWVudW3oARNzIHsKICDELjIwMjUtMTAtMDEtcHJldmlld8g1xDQgIOQA10NvbW1vblTkAY%2FHQCj1ATcuyykuyGoudjUpCiAgYNJpYCwK8ACFN%2F8Ahf8Ahf8AhesAhclpYCwKfeYBOEHoATrrAVMg6AJ15ACIbW9kZWwgRW1wbG95ZWUgaXMgVHJhY2tlZOgAgjzIHFByb3BlcnRpZXM%2B5QFpLi7pAKbkAhtQYXJhbWV0ZXLJMT476ACGyV9wyUTSfMpg6QHIQWdlIG9mIGXIP%2BUBOGFnZT86IGludDMyO%2BgBbENpdHnSKmNpdHk%2FOiBzdHLlAy7HLFByb2ZpbNNZQGVuY29kZSgiYmFzZTY0dXJsIuQBYHDGMD86IGJ5dGVzyUhUaGUgc3RhdHVzxEt0aGUgbGFzdCDkAMVhdGlvbuUDQSAgQHZpc2liaWxpdHkoTGlmZWN5Y2zkAeBhZMddxCDlA9BTdGF0xGflAavMFOkBSMRzzDLlAIDlAMph6QHVxXdAbHJvxDt1cwp1buQCctFU5QFk5gEa6QKyxF%2FIRyBjcmXEJ3JlcXVlc3QgaGFzIGJlZW4gYWNjZXB0ZWTEZyAgQccOOiAiyAsi1lBpxEDkALTpAMHIROwAnDogIswP2kx1cGRhdMRPxUNVxw46ICLIC8o76QTq6QDE5gDcZOcBolN1Y2NlZWTlAMXJDNM%2FxTbkAU1mYWlsyT5GxQ06ICLGCdw4d2FzIGNhbmNlyj5Dxw%2FkBULHC%2F8BQCBkZWxl6QGARMQN5gD5yAsi6QP96QN3bW926gHK6QN5TW92ZVLHFegDcsRzbW92xGhmcm9tIGxvY%2BYAvMVuxBPxA1DLM3RvzzF0b8ov9wCVc3BvbnPrBIvmAJbHFuwAl%2B4DbMU%2BxWTGfOYC7s1uaW50ZXJm5AZhT%2BgDlHMgZXh0ZW5kc%2FYHIy7LKXt9CuUG%2F8gjyhvLWegAzeYEs2dldOQBp0HKNeQD5%2BwFEOQEEHJl5Ab6ZEZyb23pBw4u9QXFICLmAqlPcuUC1WXlBI9AcmXkAPzqB0rVPMUqc2hhcmVkUm91dGXkBQ7NTE9sZO8ArEPHIFJlcGxhY2VBc3luY%2BwAvN9RxU71AVVMZWdhY3ku1WAKICAg6QFGLMUOT3DkAWZhbOcCm0JvZHkgPSB0cnXEdOUAiOUD%2FMZxcm1DdXN0b21QYXRjaFPXUvYAl0ZvdW7kBCvkAUPIHOYAy03kAonGSdBLyhDqBq%2FFGT7oAJ3mA5%2FvAVzlA5xlV2l0aG91dE9r8wFcbGlzdEJ5yDBHcm91cM9ETMUiUGFyZW501DxTdWJzY3Jp5QE%2BxzvGM8wZzDnoB2Ugc2FtcGzrBGthY8VEdGhhdOYDaOkHKHRvIGRpZmZl5ACE7wPrxSnuALJBxUjlAZbIdyzsBHbIDeYD7fMAkkhFQUTqB1HEfmNoZWNr6gCqZXhpc3RlbuYIyyDGHkXJFO8C4M0d7gim&e=%40azure-tools%2Ftypespec-autorest&vs=%7B%7D) showing how you would version a required to optional request body for a templated async put operation:\n```\n@armResourceOperations\ninterface Employees {\nget is ArmResourceRead<Employee>;\n@renamedFrom(Versions.`2025-10-07-preview`, \"createOrUpdate\")\n@removed(Versions.`2025-10-07-preview`)\n@sharedRoute\ncreateOrUpdateOld is ArmResourceCreateOrReplaceAsync<Employee>;\n@sharedRoute\ncreateOrUpdate is Azure.ResourceManager.Legacy.CreateOrReplaceAsync<\nEmployee,\nOptionalRequestBody = true\n>;\nupdate is ArmCustomPatchSync<\nEmployee,\nAzure.ResourceManager.Foundations.ResourceUpdateModel<\nEmployee,\nEmployeeProperties\n>\n>;\ndelete is ArmResourceDeleteWithoutOkAsync<Employee>;\nlistByResourceGroup is ArmResourceListByParent<Employee>;\nlistBySubscription is ArmListBySubscription<Employee>;\n/** A sample resource action that move employee to different location */\nmove is ArmResourceActionSync<Employee, MoveRequest, MoveResponse>;\n/** A sample HEAD operation to check resource existence */\ncheckExistence is ArmResourceCheckExistence<Employee>;\n}\n```\nthe trick is to use @sharedRoute in the old and new operations and to rename and remove the old operation in the new version.", "expected_knowledges": [{"title": "Versioning the LRO headers | question", "link": ""}, {"title": "Extra \"TypeSpec.Http.OkResponse\" schema in new Swagger | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Setting lroheader in operation does not work | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "FinalResult is not correct | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Interfaces and Operations | Azure.ResourceManager | `ArmProviderActionAsync` {#Azure.ResourceManager.ArmProviderActionAsync}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}, {"title": "Interfaces and Operations | Azure.ResourceManager.Legacy.Extension | `CreateOrReplaceAsync` {#Azure.ResourceManager.Legacy.Extension.CreateOrReplaceAsync}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}, {"title": "lro-location-header", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/rules/lro-location-header"}, {"title": "Interfaces and Operations | Azure.ResourceManager.Legacy | `RoutedOperations` {#Azure.ResourceManager.Legacy.RoutedOperations}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation | 11. ArmLroLocationHeader | TypeSpec Example", "link": ""}, {"title": "Interfaces and Operations | Azure.ResourceManager.Legacy | `ExtensionOperations` {#Azure.ResourceManager.Legacy.ExtensionOperations}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}, {"title": "Resolving OpenAPI Breaking Change Violations | Migrating ARM Specifications | Converting Synchronous Operations to LROs", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation | 11. ArmLroLocationHeader | Description", "link": ""}, {"title": "Interfaces and Operations | Azure.ResourceManager.Legacy | `CreateOrReplaceAsync` {#Azure.ResourceManager.Legacy.CreateOrReplaceAsync}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation | 4. ArmCombinedLroHeaders | Description", "link": ""}, {"title": "Usages for Illustrates bodies templated with Azure Core with long-running RPC operation | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/core/lro/rpc/main.tsp"}, {"title": "Usages for The version of the API. | Scenario: Expect to send a azureLocation value as header.", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/core/scalar/main.tsp"}, {"title": "Data types | Azure.ResourceManager | `ArmDeleteAcceptedLroResponse` {#Azure.ResourceManager.ArmDeleteAcceptedLroResponse}", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "Versioning the LRO headers | answer", "link": ""}, {"title": "Usages for Arm Resource Provider management API. | Scenario: Resource POST operation with long LRO headers", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/resource-manager/large-header/main.tsp"}, {"title": "Usages for Test for the @added decorator | Scenario: This operation should be generated with latest version's signature", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/versioning/added/main.tsp"}, {"title": "FinalResult is not correct | question", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Converting Existing Specs to Single Active Preview | `@added(T, u)` decorator", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}, {"title": "Deep Dive: Long-running (Asynchronous) Operations | Long-running Operation Helpers for Emitters and Libraries", "link": "https://azure.github.io/typespec-azure/docs/howtos/azure-core/long-running-operations"}, {"title": "Usages for Illustrates bodies templated with Azure Core with long-running operation | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/core/lro/standard/main.tsp"}, {"title": "Versioning | Using the `@added` Decorator", "link": "https://typespec.io/docs/getting-started/getting-started-rest/06-versioning"}, {"title": "The value of final-state-via in x-ms-long-running-operation-options is different from or missing compared to the original Swagger. | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Does it make sense for a put operation with Location header? | answer", "link": ""}, {"title": "Extra \"TypeSpec.Http.OkResponse\" schema in new Swagger | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Creating stable API version with select properties omitted? | answer", "link": ""}], "expected_references": [{"title": "Versioning the LRO headers | answer", "link": ""}]}
{"testcase": "Creating stable API version with select properties omitted?", "query": "title: Creating stable API version with select properties omitted?\n\nquestion: Is it possible on typeSpec to add a new preview with some new parameters and a new stable for all other properties that we already have? We have some properties that we don't want to include in a stable release just yet, but don't want that to hold us from releasing the other properties in a stable release.\nCan we have multiple versions marked with @previewVersion? How do we handle a property that is in multiple preview versions, but we want to keep out of stable versions?\nFor a practical example, we have the faultSimulation apis in our spec in 2024-11-01-preview, 2025-03-01-preview, 2025-06-01-preview, and 2025-07-01-preview. If I mark 2025-07-01-preview with @previewVersion and faultSimulation with @added(versions.v2025_07_01_preview), the generation removes it from the previous preview specs.", "ground_truth": "TypeSpec versioning works in the following way:\nAll types in the spec are automatically part of the initial api-version\nWhen a new api-version is introduced,  any new types `use@added(VERSION)` decorators to indicate they were added in that version, they are impliciutly included in every subsequent version\nWhen a type does not appear in one version, then you use `@removed(VERSION)` to remove the type at that version, by default, it will not appear any subsequent versions.  It can be added back using `@added` [Here is a playground](https://azure.github.io/typespec-azure/playground/?options=%7B%22linterRuleSet%22%3A%7B%22extends%22%3A%5B%22%40azure-tools%2Ftypespec-azure-rulesets%2Fresource-manager%22%5D%7D%7D&c=aW1wb3J0ICJAdHlwZXNwZWMvaHR0cCI7CtIZcmVzdNUZdmVyc2lvbmluZ8wfYXp1cmUtdG9vbHMvyCstxhVjb3Jl3yvIK3Jlc291cmNlLW1hbmFnZXIiOwoKdXNpbmcgSHR0cDvHDFJlc3TIDFbpAI7IEkHESi5Db3JlzhJSx1xNxls7CgovKiogQ29udG9zb8RUxR4gUHJvdmlkZXIg5gCDbWVudCBBUEkuICovCkBhcm3IIE5hbWVzcGFjZQpAc2VydmljZSgjeyB0aXRsZTogIsdXyC1IdWJDbGllbnQiIH0pCkDnAUNlZCjnAL9zKQpuyFAgTWljcm9zb2Z0LtJG7wC2QVBJIMdNc%2BQAoWVudW3oARNzIHsKICDELjIwMjEtMTAtMDEtcHJldmlld8g1xDQgIEB1c2VEZXBlbmRlbmN5KPUBLy7IVi52MV8wX1DGSF8xKcRAYXJtQ29tbW9uVOQBz8cq10jLKctUNcRIYPIAqWAsCuoAxTTGHP8Avf8Avf8Avf8Avf4AvecAoe0AtTUtMDf%2FAXr%2FAL3%2FAL3%2FAL3%2FAL3qAL3vAKlgLAp95gJtQegCb%2BsCiCDoA6rkAMhtb2RlbCBFbXBsb3llZSBpcyBUcmFja2Vk6ACCPMgcUHJvcGVydGllcz7lAp4uLukApuQDUFBhcmFtZXRlcskxPjvoAIbJX3DJRNJ8ymDpAv1BZ2Ugb2YgZcg%2F5gF4YWRk6wN%2BLuwBveQBEGFnZT86IGludDMyO%2BgBzENpdHnSSmNpdHk%2FOiBzdHLlBIPHLFByb2ZpbNR5cmVtb3bce%2FQAm%2FABm8UoZW5jb2RlKCJiYXNlNjR1cmwixBdwxno%2FOiBieXRlc%2BkAklRoZSBzdGF0dXPkAJV0aGUgbGFzdCDkAS9hdGlvbuUE4CAgQHZpc2liaWxpdHkoTGlmZWN5Y2zkAkphZMddxCDlBW9TdGF0xGflAhXMFOkBssRzzDLlAIDlARRh6QI%2FxXdAbHJvxDt1cwp1buQDHNFU5QHO5gFk6QNcxF%2FIRyBjcmXEJ3JlcXVlc3QgaGFzIGJlZW4gYWNjZXB0ZWTEZyAgQccOOiAiyAsi1lBpxEDkALTpAMHIROwAnDogIswP2kx1cGRhdMRPxUNVxw46ICLIC8o76QaJ6QDE5gDcZOcBolN1Y2NlZWTlAMXJDNM%2FxTbkAU1mYWlsyT5GxQ06ICLGCdw4d2FzIGNhbmNlyj5Dxw%2FkBuHHC%2F8BQCBkZWxl6QGARMQN5gD5yAsi6QRn6QPh5AMh6QHK6QPjTW92ZVLHFegD3MRzbW92xGhmcm9tIGxvY%2BYAvMVuxBPxA5rLM3RvzzF0b8ov9wCVc3BvbnPrBPXmAJbHFuwAl%2B4DbMU%2BxWTGfOYC7s1uaW50ZXJm5AgAT%2BgDlHMgZXh0ZW5kc%2FYIwi7LKXt9CuUInsgjyhvLWegAzeYFHWdldOQBp0HKNeQD5%2BwFeiDnAntPcuUCp%2BUB1ssvQ8cdUmVwbGFjZUFzeW5jzj%2FlAvfIN0N1c3RvbVBhdGNoU8QqCiAgIOkAkyzFDvYA50ZvdW7kAybkBQ7IHOYAkU3kAYTGSdBLyhDqBhTFGT4KICDlAJ3mAprvANTlApdlV2l0aG91dE9r8wDUbGlzdEJ5yDBHcm91cM9ETMUiUGFyZW501DxTdWJzY3JpcOUCecY7xjPMGcw56AbKIHNhbXBs6wNmYWPFRHRoYXTmAmPpBm10byBkaWZmZeQAhO8C5sUp7gCyQcVI5QGWyHcs7ANxyA3mAujzAJJIRUFE6gZMxH5jaGVja%2BoAqmV4aXN0ZW7mCDAgxh5FyRTvAljNHe4ICw%3D%3D&e=%40azure-tools%2Ftypespec-autorest&vs=%7B%7D)\n```\n/** Contoso API versions */\nenum Versions {\n/** 2021-10-01-preview version */\n@useDependency(Azure.ResourceManager.Versions.v1_0_Preview_1)\n@armCommonTypesVersion(Azure.ResourceManager.CommonTypes.Versions.v5)\n`2021-10-01-preview`,\n/** 2024-10-01 version */\n@useDependency(Azure.ResourceManager.Versions.v1_0_Preview_1)\n@armCommonTypesVersion(Azure.ResourceManager.CommonTypes.Versions.v5)\n`2024-10-01`,\n/** 2025-07-01-preview version */\n@useDependency(Azure.ResourceManager.Versions.v1_0_Preview_1)\n@armCommonTypesVersion(Azure.ResourceManager.CommonTypes.Versions.v5)\n`2025-07-01-preview`,\n}\n/** A ContosoProviderHub resource */\nmodel Employee is TrackedResource<EmployeeProperties> {\n...ResourceNameParameter<Employee>;\n}\n/** Employee properties */\nmodel EmployeeProperties {\n/** Age of employee */\n@added(Versions.`2024-10-01`)\nage?: int32;\n/** City of employee */\ncity?: string;\n/** Profile of employee */\n@removed(Versions.`2024-10-01`)\n@added(Versions.`2025-07-01-preview`)\n@encode(\"base64url\")\nprofile?: bytes;\n/** The status of the last operation. */\n@visibility(Lifecycle.Read)\nprovisioningState?: ProvisioningState;\n}\n```\nshowing two propertties (EmployeeProperties.age and EmployeeProperties.profile) that use versioning.  'age' appears in the second, stable version and all subsequent versions,  'profile' appears in the first (preview) version, is removed in the stable version, and then added back again in the subsequent preview version.\nNotably, this practice of adding a property at each preview version and removing it at each stable is easy to get wrong.\nthe official Azure policy is to have only one active preview, as much as that is possible with api retention requirements.  So that, when you introduce a new preview version, the older preview is removed, ideally, this means that, especially when you just had a stable release, you remove support for the previous preview when (or soon after) you add the new preview version.\nYou can see more details about versioning in typespec here: [Versioning | TypeSpec Azure](https://azure.github.io/typespec-azure/docs/getstarted/versioning/)", "expected_knowledges": [{"title": "Creating stable API version with select properties omitted? | question", "link": ""}, {"title": "Creating stable API version with select properties omitted? | answer", "link": ""}, {"title": "Creating stable API version with select properties omitted? | answer", "link": ""}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/01-about-versioning"}, {"title": "Adding a Preview Version when the Last Version was Preview | The Simplest Case: No Stable api-versions", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/02-preview-after-preview"}, {"title": "How to Manage a Single Active Preview When Some Features Always Remain In Preview", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/02-perpetual-preview"}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/01-about-versioning"}, {"title": "Adding a Stable Version when the Last Version was Preview | Making Changes to your TypeSpec spec", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/03-stable-after-preview"}, {"title": "Adding a Preview Version when the Last Version was Stable", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/04-preview-after-stable"}, {"title": "Adding a Stable Version when the Last Version was Preview | Making Changes to your TypeSpec spec", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/03-stable-after-preview"}, {"title": "Adding a Stable Version when the Last Version was Preview", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/03-stable-after-preview"}, {"title": "Adding a Preview Version when the Last Version was Preview | The General Case: One or more Stable Versions Exist | Making Changes to your TypeSpec spec", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/02-preview-after-preview"}, {"title": "Adding a Stable Version when the Last Version was Stable", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/05-stable-after-stable"}, {"title": "Versioning | Adding a Property or Parameter", "link": "https://azure.github.io/typespec-azure/docs/getstarted/versioning"}, {"title": "Versioning | Multiple api versions | Default", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/10versioning"}, {"title": "Versioning | Simple Scenarios", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Adding a Preview Version when the Last Version was Stable", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/04-preview-after-stable"}, {"title": "Creating stable API version with select properties omitted? | question", "link": ""}, {"title": "Scenarios for API Evolution | Replacing a Preview API with a new Stable and a Preview API (previous stable API exists) | TypeSpec Steps", "link": ""}, {"title": "Converting Existing Specs to Single Active Preview | `@added(T, u)` decorator", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}, {"title": "Release new api version process with TypeSpec | answer", "link": ""}, {"title": "How to define a preview version | Preview Versioning Rules for All Azure APIs", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/01-preview-version"}, {"title": "Handling multiple API versions using typespec | answer", "link": ""}, {"title": "9. Versioning | Versioning your service", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-core/step09"}, {"title": "Output folder 'ContentUnderstanding' appears to contain TypeSpec-generated swagger files, not generated from the current TypeSpec sources. Perhaps you deleted a version from your TypeSpec, but didn't delete the associated swaggers? | question", "link": ""}], "expected_references": [{"title": "How to define a preview version | Preview Versioning Rules for All Azure APIs", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/01-preview-version"}, {"title": "Creating stable API version with select properties omitted? | answer", "link": ""}, {"title": "Adding a Stable Version when the Last Version was Preview | Making Changes to your TypeSpec spec", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/03-stable-after-preview"}, {"title": "How to Manage a Single Active Preview When Some Features Always Remain In Preview", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/02-perpetual-preview"}]}
