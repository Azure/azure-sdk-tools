parameters:
  Directory: 'not-specified'
  IgnoreLinksFile: "$(Build.SourcesDirectory)/eng/ignore-links.txt"
  
steps:
- pwsh: |
    try {
      echo "##vso[task.setvariable variable=replacedBranch]$(system.pullRequest.sourceCommitId)"
    } catch {
      echo "##vso[task.setvariable variable=replacedBranch]''"
      echo "It is not a pr triggered build."
    }

  displayName: Triggered by PR check
  workingDirectory: ${{ parameters.WorkingDirectory }}
  ignoreLASTEXITCODE: true
- task: PowerShell@2
  displayName: Link verification check
  inputs:
    pwsh: true
    workingDirectory: $(Build.SourcesDirectory)/${{ parameters.Directory }}
    filePath: eng/common/scripts/Verify-Links.ps1 
    arguments: >
      -urls $(dir -r -i *.md) 
      -rootUrl "file://$(Build.SourcesDirectory)/${{ parameters.Directory }}" 
      -recursive $false 
      -ignoreLinksFile ${{ parameters.IgnoreLinksFile }}
      -branchReplaceRegex "(https://github.com/.*/blob/)master(/.*)"
      -branchReplacementName $(replacedBranch)