{"testcase": "What decorator should be used in this case?", "query": "title: What decorator should be used in this case?\n\nquestion: Hi team,\nIn version v2, we introduced a new model model2 and updated featureA (originally added in v1) to use model2 as its parameter. In v1, featureA used model1 at the same position.\nHere’s the setup I tried (using @typeChangedFrom):\n```\n@added(v1)\nmodel1;\n@added(v2)\nmodel2;\n@added(v1)\nfeatureA {\n@typeChangedFrom(v1, model1)\nbody: model2;\n}\n```\nHowever, this shows the error: \"model2 does not exist in v1\".\nWhat would be the correct decorator to use in this situation?\nThank you!", "ground_truth": "it should be `typedChangedFrom(v2, model1)` here otherwise you are saying in v1 you changed from using model1 to model2 which then of course doesn't exists", "expected_knowledges": [{"title": "What decorator should be used in this case? | question", "link": ""}, {"title": "What decorator should be used in this case? | answer", "link": ""}, {"title": "Versioning | Adding a Resource or Operation", "link": "https://azure.github.io/typespec-azure/docs/getstarted/versioning"}, {"title": "Decorators | Applying decorators", "link": "https://typespec.io/docs/language-basics/decorators"}, {"title": "Versioning | Versioning Decorators | @madeRequired and @madeOptional", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Is it possible to make a field to be optional only on new api version? | answer", "link": ""}, {"title": "Versioning | Introduction", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Versioning | Introduction", "link": "https://typespec.io/docs/getting-started/getting-started-rest/06-versioning"}, {"title": "Decorators | Augmenting decorators", "link": "https://typespec.io/docs/language-basics/decorators"}, {"title": "Versioning | Simple Scenarios | Adding Decoration to an Existing Type", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Usages for Test for the `@removed` decorator. | Scenario: This operation should be generated with latest version's signature.", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/versioning/removed/main.tsp"}, {"title": "Versioning | Using the `@added` Decorator", "link": "https://typespec.io/docs/getting-started/getting-started-rest/06-versioning"}, {"title": "Versioning | Simple Scenarios", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Authentication | Conclusion", "link": "https://typespec.io/docs/getting-started/getting-started-rest/05-authentication"}, {"title": "Examples | Type Examples", "link": "https://typespec.io/docs/standard-library/examples"}, {"title": "Versioning | Versioning Decorators | @added", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Generated Types | Using `@alternateType` to Reference External Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Usages for Test for the @added decorator | Scenario: This operation should only be generated with latest version", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/versioning/added/main.tsp"}, {"title": "Generated Types | Client Default Values (Legacy)", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Versioning | Introduction to the `@versioned` Decorator", "link": "https://typespec.io/docs/getting-started/getting-started-rest/06-versioning"}, {"title": "OpenAPI3 to TypeSpec | Detailed Example for Converting Component Parameters | TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "How to Manage a Single Active Preview When Some Features Always Remain In Preview | Create A Copy of the Spec for the Stable Version only", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/02-perpetual-preview"}, {"title": "Release new api version process with TypeSpec | answer", "link": ""}, {"title": "Handling multiple API versions using typespec | answer", "link": ""}, {"title": "How to update any model without affecting old API versions | answer", "link": ""}, {"title": "TypeSpec ARM Decorator Mapping to Swagger Documentation | 1. @armCommonTypesVersion | Description", "link": ""}, {"title": "9. Versioning | Versioning your service", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-core/step09"}, {"title": "Converting Existing Specs to Single Active Preview | Normalizing Version Decoration (optional)", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}, {"title": "Converting Existing Specs to Single Active Preview | Normalizing Version Decoration (optional)", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}, {"title": "Converting Existing Specs to Single Active Preview | `@typeChangedFrom(T, u, type)` decorator", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/uncommon-scenarios/01-converting-specs"}], "expected_references": [{"title": "What decorator should be used in this case? | answer", "link": ""}]}
{"testcase": "Hi team, could someone please help grant me permission to view the workflow for my Azure REST API PR?", "query": "title: Hi team, could someone please help grant me permission to view the workflow for my Azure REST API PR?\n\nquestion: Right now, after pushing my commit, I’m unable to see the error details for the validation checks, it just says “at least one review required to see the workflow.” This makes it difficult to verify if my changes are passing validation before the final review.\nWould it be possible to enable workflow visibility for me so I can debug and ensure everything is in order ahead of time? PR link: [Stable version 2025-09-01 with prevalidation and autoscale changes by prachinandi · Pull Request #3…](https://github.com/Azure/azure-rest-api-specs/pull/37218)", "ground_truth": "You need to get the necessary permissions, see here: https://aka.ms/azsdk/access", "expected_knowledges": [{"title": "Hi team, could someone please help grant me permission to view the workflow for my Azure REST API PR? | answer", "link": ""}, {"title": "Hi team, could someone please help grant me permission to view the workflow for my Azure REST API PR? | question", "link": ""}, {"title": "", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Home"}, {"title": "PR gateway pipelines not starting/waiting for long time | answer", "link": ""}, {"title": "Create a pull request with your Azure REST API spec update", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs-pr/api-specs-pr"}, {"title": "Table of Contents | How to Re-evaluate `SDK Validation Status` Check", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/SDK-Validation"}, {"title": "Known Issues | MULTIPLE_API_VERSION", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado"}, {"title": "", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs-pr/api-tutorial/api-tutorial-1-branch"}, {"title": "How do I onboard my API to publish docs?", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/API-Doc-Preview"}, {"title": "Microsoft Azure REST API Guidelines | Building Blocks: HTTP, REST, & JSON", "link": "https://github.com/microsoft/api-guidelines/blob/vNext/azure/Guidelines.md"}, {"title": "Versions | Version 1 | Spec", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Folder-Structure"}, {"title": "Uniform Versioning Violation Guide | Getting Help", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Uniform-Versioning-Violation-Guide"}, {"title": "Extra \"TypeSpec.Http.OkResponse\" schema in new Swagger | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Microsoft Azure REST API Guidelines", "link": "https://github.com/microsoft/api-guidelines/blob/vNext/azure/Guidelines.md"}, {"title": "Troubleshooting REST API documentation | I can't access pipeline logs for REST API Docs Preview builds", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-docs-troubleshooting"}, {"title": "Docs", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-BreakingChanges"}, {"title": "How do I troubleshoot docs build problems?", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/API-Doc-Preview"}, {"title": "missing `x-ms-pageable` for paging operation | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Suppress validation failures on a PR", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "missing externalDocs | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/API-Spec-Review-FAQ"}, {"title": "Hi team, could someone please help grant me permission to view the workflow for my Azure REST API PR? | question", "link": ""}], "expected_references": [{"title": "Hi team, could someone please help grant me permission to view the workflow for my Azure REST API PR? | answer", "link": ""}, {"title": "How to Re-evaluate `SDK Validation Status` Check", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/SDK-Validation"}]}
{"testcase": "Service under conversation label", "query": "title: Service under conversation label\n\nquestion: My team currently has a PR open to release a new stable API. However, due to backend delays, it’s been open since July. During that time, the [typespec migration PR](https://github.com/Azure/azure-rest-api-specs/pull/36556) was drafted against our preview API. Now, the service-under-conversion label has been added to our stable PR. I’d like to understand does this label indicate a delay in merging in our [stable api PR](https://github.com/Azure/azure-rest-api-specs/pull/36219), or will we need to make additional changes?", "ground_truth": "The label should not impact your previous PR, and , if this is a later api-version thatn the conversion PR, the conversion would normally be based on that version once checked in.", "expected_knowledges": [{"title": "Service under conversation label | question", "link": ""}, {"title": "Service under conversation label | answer", "link": ""}, {"title": "Reproducibility", "link": "https://typespec.io/docs/handbook/reproducibility"}, {"title": "Extra \"Azure.ResourceManager.ArmResponse<ResponseModel>\" schema in new Swagger | question", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Extra \"TypeSpec.Http.OkResponse\" schema in new Swagger | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Breaking Change(Cross-Version) failure | question", "link": ""}, {"title": "Custom Response Models | Conclusion", "link": "https://typespec.io/docs/getting-started/getting-started-rest/07-custom-response-models"}, {"title": "Uniform Versioning Violation Guide | How to Suppress Uniform Versioning Violations", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Uniform-Versioning-Violation-Guide"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation | 1. ArmAcceptedLroResponse | Description", "link": ""}, {"title": "rename duplicated model `Resource` | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Custom Response Models | Introduction", "link": "https://typespec.io/docs/getting-started/getting-started-rest/07-custom-response-models"}, {"title": "Common Parameters | Conclusion", "link": "https://typespec.io/docs/getting-started/getting-started-rest/04-common-parameters"}, {"title": "Create a pull request with your Azure REST API spec update", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs-pr/api-specs-pr"}, {"title": "bad | Troubleshooting AutoRest suppressions not working | Ensure you are suppressing the right tag (API version)", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "TypeSpec for OpenAPI Developers | Consumes / Produces (OAS2)", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "TypeSpec for OpenAPI Developers", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "Common Parameters | Introduction", "link": "https://typespec.io/docs/getting-started/getting-started-rest/04-common-parameters"}, {"title": "Creating a project | Target Users", "link": "https://azure.github.io/typespec-azure/docs/getstarted/createproject"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation | 36. ProviderNamespace | TypeSpec Example", "link": ""}, {"title": "Custom Response Models | Using Custom Response Models in Operations", "link": "https://typespec.io/docs/getting-started/getting-started-rest/07-custom-response-models"}, {"title": "Service under conversation label | answer", "link": ""}, {"title": "Resolving Folder Migration Conflicts: A Guide for PR Authors | Understanding Folder Migration | Folder Structure Change", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Resolving-Folder-Migration-Conflicts:-A-Guide-for-PR-Authors"}, {"title": "Scenarios for API Evolution | Replacing a Preview API with a new Stable and a Preview API (previous stable API exists) | TypeSpec Steps", "link": ""}, {"title": "Azure Versioning Guidelines | Guidelines", "link": "https://github.com/microsoft/api-guidelines/blob/vNext/azure/VersioningGuidelines.md"}, {"title": "Verify generated files match expectations by checking if there's any diff with the OpenAPI json files. | Getting Help | Support Channels", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Resolving-Folder-Migration-Conflicts:-A-Guide-for-PR-Authors"}, {"title": "Azure REST API Specification Directory Structure | Contact Us", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Specification-Folder-Structure-Guide"}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/arm/01-about-versioning"}, {"title": "Handling multiple API versions using typespec | answer", "link": ""}, {"title": "Is TypeSpec migration complete for folder: recoveryservicesbackup. | question", "link": ""}, {"title": "Service under conversation label | question", "link": ""}], "expected_references": [{"title": "Service under conversation label | answer", "link": ""}]}
{"testcase": "Design question about suppression rules", "query": "title: Design question about suppression rules\n\nquestion: Hi team,\nWe're working to put together a TypeSpec definitions package for OpenAI API surface.\nThis will then get consumed by teams authoring Azure APIs. As such, they have the Azure linting in place (naming conventions and whatnot).\nWe wanted to know whether definitions can also come with suppressions (not inline, as this definition is auto-importer on a regular basis), which would apply ONLY to the definitions we share, not to the rest of the consumer's project?\nThanks!", "ground_truth": "suppression can only be provided inline for now. Linter rules can be disabled globally but that would apply to the whole project, can't filter by files", "expected_knowledges": [{"title": "Swagger LintDiff validation for certain models | question", "link": ""}, {"title": "Record<Element> type | answer", "link": ""}, {"title": "TypeSpec | `AvoidAnonymousTypes`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "TypeSpec | `AvoidAnonymousParameter` | data-plane", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Suppressing Failures", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Requirement"}, {"title": "ARM Rules, TypeSpec Linting, and Suppression | ARM RPC Rules", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/arm-rules"}, {"title": "TypeSpec | `IntegerTypeMustHaveFormat`", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "bad | Troubleshooting AutoRest suppressions not working | Verify your 'where' path with jsonpath and ensure proper escaping", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "Validation Rule Suppression", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Validation"}, {"title": "Swagger breaking change | answer", "link": ""}, {"title": "lack of  final-state-vis: azure-async-operation | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Same response model is used both in pageable operation and non-pageable operation | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "TypeSpec | `AvoidAnonymousParameter` | resource-manager", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Usages for Illustrates various property types for models | Scenario: Get call", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/type/property/value-types/main.tsp"}, {"title": "missing `x-ms-secret` | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "How to suppress warnings | Workaround", "link": "https://azure.github.io/typespec-azure/docs/troubleshoot/suppresswarnings"}, {"title": "Renaming Specs", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Requirement"}, {"title": "What is TypeSpec? | Case Studies", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "How to suppress warnings", "link": "https://azure.github.io/typespec-azure/docs/troubleshoot/suppresswarnings"}, {"title": "Suppress validation failures on a PR", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-suppressions"}, {"title": "Swagger LintDiff validation for certain models | question", "link": ""}, {"title": "TypeSpec", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "After migration - in data-plane/DynamicSessions/tspconfig.yaml", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Resolving-Folder-Migration-Conflicts:-A-Guide-for-PR-Authors"}, {"title": "Suppressing Failures", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Requirement"}, {"title": "Validation Rule Suppression", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Validation"}, {"title": "ARM Rules, TypeSpec Linting, and Suppression | Detecting and Suppressing Rule Violations at Design Time", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/arm-rules"}, {"title": "Table of Contents | How to Suppress the SDK Breaking Changes | Next Steps", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/SDK-Breaking-Changes"}], "expected_references": [{"title": "Swagger LintDiff validation for certain models | question", "link": ""}]}
{"testcase": "what's typespec", "query": "title: what's typespec\n\nquestion: what's typespec?", "ground_truth": "TypeSpec is a language and toolset developed by Microsoft for defining APIs and data models in a structured, reusable, and extensible way. It is similar to TypeScript in syntax, but is specifically designed for describing the shape and behavior of APIs (such as REST, gRPC, or GraphQL), not for general-purpose programming.\nTypeSpec allows you to:\nDefine the interface of your API, including operations, request/response models, and error handling.\nGenerate artifacts such as OpenAPI (Swagger) specifications, SDKs, and documentation from a single source of truth.\nEnforce API design consistency and reduce errors, especially in large organizations or when following strict guidelines (like Azure's API standards).\nReuse and extend models and patterns using TypeSpec libraries and templates.\nFor Azure, TypeSpec has dedicated extensions and libraries that help you follow Azure API guidelines and make it easier to build ARM (Azure Resource Manager) and data-plane services. Using TypeSpec leads to APIs that are easier to review, more consistent, and better supported by tooling.\nYou can get started by installing the TypeSpec CLI and using templates to quickly scaffold a project. For more information, see the official documentation linked below.", "expected_knowledges": [{"title": "Convert OpenAPI specs to TypeSpec | Before you begin | Overview of TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Getting Started with TypeSpec For REST APIs | Introduction | What is TypeSpec?", "link": "https://typespec.io/docs/getting-started/getting-started-rest/01-setup-basic-syntax"}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/intro"}, {"title": "Creating a TypeSpec Library", "link": "https://typespec.io/docs/extending-typespec/basics"}, {"title": "TypeSpec for OpenAPI Developers", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "nullable with other decorators | question", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "remove body for common op | question", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "TypeSpec AutoRest Library", "link": "https://azure.github.io/typespec-azure/docs/emitters/typespec-autorest/index"}, {"title": "remove body for common op | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "VS Code Extension | Features", "link": "https://typespec.io/docs/introduction/editor/vscode"}, {"title": "TypeSpec ARM Interface Mapping to Swagger Documentation", "link": ""}, {"title": "Discriminated Types", "link": "https://typespec.io/docs/standard-library/discriminated-types"}, {"title": "TypeSpec ARM Decorator Mapping to Swagger Documentation", "link": ""}, {"title": "Getting Started with TypeSpec For REST APIs | Defining Models", "link": "https://typespec.io/docs/getting-started/getting-started-rest/01-setup-basic-syntax"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "Release new api version process with TypeSpec | answer", "link": ""}, {"title": "Usages for Test for loading JSON example and generating sample code. | Full Sample:", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/example/basic/main.tsp"}, {"title": "OpenAPI v3 emitter | Models and Enums | Type Mapping", "link": "https://typespec.io/docs/emitters/openapi3/openapi"}, {"title": "Getting Started with TypeSpec For REST APIs | Defining a REST Service | Example: Defining a Service with a Title and Server Endpoint", "link": "https://typespec.io/docs/getting-started/getting-started-rest/01-setup-basic-syntax"}, {"title": "Convert OpenAPI specs to TypeSpec | Conversion process | TypeSpec conversion tool", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "Getting Started with TypeSpec For REST APIs | Basic Syntax and Structure", "link": "https://typespec.io/docs/getting-started/getting-started-rest/01-setup-basic-syntax"}, {"title": "TypeSpec for OpenAPI Developers", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/intro"}], "expected_references": [{"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Getting Started with TypeSpec For REST APIs | Introduction | What is TypeSpec?", "link": "https://typespec.io/docs/getting-started/getting-started-rest/01-setup-basic-syntax"}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/intro"}]}
{"testcase": "How to reserve \"x-ms-discriminator-value\"", "query": "title: How to reserve \"x-ms-discriminator-value\"\n\nquestion: I'm doing migration for an swagger project.\nthe old version swagger is:\n```\n\"AzureBackupRecoveryPointBasedRestoreRequest\": {\n\"type\": \"object\",\n\"title\": \"AzureBackupRecoveryPointBasedRestoreRequest\",\n\"properties\": {\n\"recoveryPointId\": {\n\"type\": \"string\"\n}\n},\n\"required\": [\n\"recoveryPointId\"\n],\n\"allOf\": [\n{\n\"$ref\": \"#/definitions/AzureBackupRestoreRequest\"\n}\n],\n\"x-ms-discriminator-value\": \"AzureBackupRecoveryPointBasedRestoreRequest\"\n},\n```\nthe converted typespec is:\n```\n@discriminator(\"objectType\")\nmodel AzureBackupRecoveryPointBasedRestoreRequest\nextends AzureBackupRestoreRequest {\nrecoveryPointId: string;\n}\n@discriminator(\"objectType\")\nmodel AzureBackupRestoreRequest {\nobjectType: string;\n/**\n* Gets or sets the restore target information.\n*/\nrestoreTargetInfo: RestoreTargetInfoBase;\n/**\n* Gets or sets the type of the source data store.\n*/\nsourceDataStoreType: SourceDataStoreType;\n/**\n* Fully qualified Azure Resource Manager ID of the datasource which is being recovered.\n*/\nsourceResourceId?: string;\n/**\n* ResourceGuardOperationRequests on which LAC check will be performed\n*/\nresourceGuardOperationRequests?: string[];\n/**\n* Contains information of the Identity Details for the BI.\n* If it is null, default will be considered as System Assigned.\n*/\nidentityDetails?: IdentityDetails;\n}\n```\nand the generated swagger from typespec is:\n```\n\"AzureBackupRecoveryPointBasedRestoreRequest\": {\n\"type\": \"object\",\n\"properties\": {\n\"objectType\": {\n\"type\": \"string\"\n},\n\"recoveryPointId\": {\n\"type\": \"string\"\n}\n},\n\"discriminator\": \"objectType\",\n\"required\": [\n\"objectType\",\n\"recoveryPointId\"\n],\n\"allOf\": [\n{\n\"$ref\": \"#/definitions/AzureBackupRestoreRequest\"\n}\n]\n},\n```\nThere has two problems:\n1.The generated swagger missed x-ms-discriminator-value flag but add discriminator flag, does it by design?\n2.The generated swagger has duplicate property 'objectType' since AzureBackupRestoreRequest already has this property", "ground_truth": "Let's address both of your issues with the TypeSpec migration and generated Swagger:\n1. Missing x-ms-discriminator-value and presence of discriminator:\nYes, this is by design. The TypeSpec emitter uses the standard OpenAPI 3 discriminator property, not the Azure-specific x-ms-discriminator-value. The @discriminator decorator in TypeSpec results in the discriminator field in the generated OpenAPI, as per the latest OpenAPI and Azure SDK standards. This approach provides better compatibility with code generators and client SDKs. The use of x-ms-discriminator-value is not needed when the discriminator field is present and correctly configured.\nSee the TypeSpec documentation and Azure guidelines for more.\n2. Duplicate objectType property in generated Swagger:\nThis is a known limitation of how inheritance and discriminator are currently handled in TypeSpec to OpenAPI conversion. If both the base (AzureBackupRestoreRequest) and the derived model (AzureBackupRecoveryPointBasedRestoreRequest) define the objectType property, OpenAPI will reflect both in the derived model, leading to apparent duplication.\nThis does not cause functional issues, but it can be confusing. The current best practice is to only define the discriminator property (objectType) in the base model and set its value in the derived models, rather than redefining the property. In TypeSpec, this would look like:\n```\n@discriminator(\"objectType\")\nmodel AzureBackupRestoreRequest {\nobjectType: string;\n// ... other properties ...\n}\nmodel AzureBackupRecoveryPointBasedRestoreRequest extends AzureBackupRestoreRequest {\nobjectType: \"AzureBackupRecoveryPointBasedRestoreRequest\";\nrecoveryPointId: string;\n}\n```\nThis way, the objectType property is only defined in the base model, and the derived model just sets its value. This should prevent duplication in the emitted Swagger.\nAction Items:\nRefactor your TypeSpec so that only the base model defines the discriminator property (objectType), and the derived models assign its value.\nDo not worry about x-ms-discriminator-value not being present: it is not required when the standard discriminator property is used.", "expected_knowledges": [{"title": "Emitter usage | Emitter options | `polymorphic-models-strategy`", "link": "https://typespec.io/docs/emitters/json-schema/reference/emitter"}, {"title": "Tutorial | Versioning APIs", "link": "https://typespec.io/docs/libraries/versioning/guide"}, {"title": "TypeSpec for OpenAPI Developers | Schema Object | allOf and polymorphism using allOf", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "OpenAPI v3 emitter | Model Composition | Extends Keyword", "link": "https://typespec.io/docs/emitters/openapi3/openapi"}, {"title": "Azure REST API Specification Directory Structure", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Specification-Folder-Structure-Guide"}, {"title": "TypeSpec Azure.ResourceManager.Legacy Decorators Mapping to Swagger Documentation | 3. @customAzureResource | Swagger Output", "link": ""}, {"title": "OpenAPI3 to TypeSpec | Examples | 1. Convert component schemas into models", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "Common Parameters | Reusing Common Parameters Across Multiple Operations | Example: OpenAPI Specification for Common Parameters", "link": "https://typespec.io/docs/getting-started/getting-started-rest/04-common-parameters"}, {"title": "equivalent PrxoyResource even without system data | question", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Azure Versioning and Breaking Changes Policy V1.3.2 | 5. Azure Service Change Impact | Table 2: Changes requiring a review with Azure's Breaking Change Review Board", "link": ""}, {"title": "how do i use discriminated union | answer", "link": ""}, {"title": "Usages for Illustrates inheritance with single discriminator. | Scenario: Generate and send polymorphic model in single level inheritance with 1 discriminator.", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/type/model/inheritance/single-discriminator/main.tsp"}, {"title": "Built-in Decorators | TypeSpec | `@discriminator` {#@discriminator}", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Built-in Data types | TypeSpec | `DiscriminatedOptions` {#DiscriminatedOptions}", "link": "https://typespec.io/docs/standard-library/built-in-data-types"}, {"title": "TypeSpec for OpenAPI Developers | Parameter Object | OpenAPI v3", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "What is TypeSpec? | Case Studies | Azure Batch", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Multiple layers of inheritance for discriminative model | question", "link": ""}, {"title": "Changing Property to Optional with Default | answer", "link": ""}, {"title": "error duplicate-property in @azure-tools/typespec-azure-resource-manager/lib tsp | answer", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "TypeSpec for OpenAPI Developers | Schema Object | Polymorphism using anyOf and oneOf (OAS3)", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "Duplicate model definition errors on compilation with TypeSpec Compiler v1.0.0 - Microsoft.Mission | question", "link": ""}, {"title": "Generated Types | Models | Discriminator", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Discriminated Types | Implementing Discriminated Unions", "link": "https://typespec.io/docs/standard-library/discriminated-types"}, {"title": "Does TypeSpec have the option to achieve mutually exclusive? | answer", "link": ""}, {"title": "Usages for Illustrates inheritance with single discriminator. | Full Sample:", "link": "https://github.com/microsoft/typespec/tree/main/packages/http-specs/specs/type/model/inheritance/single-discriminator/main.tsp"}, {"title": "Is it possible to make a field to be optional only on new api version? | question", "link": ""}], "expected_references": [{"title": "Generated Types | Models | Discriminator", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "OpenAPI v3 emitter | Model Composition | Extends Keyword", "link": "https://typespec.io/docs/emitters/openapi3/openapi"}, {"title": "Built-in Decorators | TypeSpec | `@discriminator`", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}]}
