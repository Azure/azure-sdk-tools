parameters:
  Directory: 'not-specified'
  IgnoreLinksFile: "$(Build.SourcesDirectory)/eng/ignore-links.txt"
  WorkingDirectory: "$(System.DefaultWorkingDirectory)"
  ScriptDirectory: "eng/common/scripts"
  Urls: "$(dir -r -i *.md)"
  Recursive: false 
  Branchreplaceregex: "$(System.PullRequest.SourceRepositoryURI)"
  Branchreplacementname: "$(System.PullRequest.SourceCommitId)"
  Checklinkguidance: true
steps:
  - task: PowerShell@2
    displayName: Link verification check
    inputs:
      pwsh: true
      workingDirectory: "${{ parameters.WorkingDirectory }}/${{ parameters.Directory }}"
      filePath: ${{ parameters.ScriptDirectory }}/Verify-Links.ps1
      arguments: >
        -urls ${{ parameters.Urls }}
        -rootUrl "file://${{ parameters.WorkingDirectory }}/${{ parameters.Directory }}" 
        -recursive: ${{ parameters.Recursive }} 
        -ignoreLinksFile ${{ parameters.IgnoreLinksFile }}
        -branchReplaceRegex "^(${{ parameters.Branchreplaceregex }}.*/(?:blob|tree)/)master(/.*)$"
        -branchReplacementName ${{ parameters.Branchreplacementname }}
        -devOpsLogging: $true
        -checkLinkGuidance: ${{ parameters.Checklinkguidance }}
