trigger: none
pr: none

pool:
  name: azsdk-pool-mms-ubuntu-2204-general
  vmImage: ubuntu-22.04

jobs:
- job: TestTokenUsage
  displayName: TestToken

  steps:
  - task: Powershell@2
    displayName: Get an installation token
    env:
      APP_PRIVATE_KEY: $(AppPrivateKey)
      REPOSITORY: Azure/azure-sdk-for-net-pr
    inputs:
      targetType: filePath
      filePath: eng/scripts/Set-GitHubTokenVariable.ps1
      pwsh: true
      arguments: >
        -AppId 1003147
        -AppKey $env:APP_PRIVATE_KEY
        -Repository $env:REPOSITORY
        -VariableName 'githubtoken'
  
  - task: Powershell@2
    displayName: Use the token
    env:
      GH_TOKEN: $(githubtoken)
      REPOSITORY: Azure/azure-sdk-for-net-pr
    inputs:
      targetType: inline
      script: |
        gh pr list --repo $env:REPOSITORY --limit 2
