# Inventory PowerShell modules installed

trigger: none

strategy:
  maxParallel: 3
  matrix:
    Linux:
      Pool: Azure Pipelines
      OSVmImage: ubuntu-latest
    Windows:
      Pool: Azure Pipelines
      OSVmImage: windows-latest
    MacOS:
      Pool: Azure Pipelines
      OSVmImage: macOS-latest
    CustomLinux:
      Pool: azsdk-pool-mms-ubuntu-2004-general
      OSVmImage: MMSUbuntu20.04
    CustomWindows:
      Pool: azsdk-pool-mms-win-2022-general
      OSVmImage: MMS2022
    CustomMacOS:
      Pool: Azure Pipelines
      OSVmImage: macos-11

pool:
  name: $(Pool)
  vmImage: $(OSVmImage)

steps:
- bash: sudo chown -R runner ~/.Azure
  displayName: (MacOS) Grant access to ~/.Azure
  condition: contains(variables['OSVmImage'], 'mac')

- bash: dotnet --info

- pwsh: |
    eng/common/TestResources/Import-AzModules.ps1
    Get-Module -List
