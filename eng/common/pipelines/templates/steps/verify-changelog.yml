parameters:
- name: ServiceName
  type: string
  default: 'not-specified'
- name: ForRelease
  type: string
  default: ''
- name: Artifacts
  type: object
  default: []

steps:
  - template: /eng/common/pipelines/templates/steps/run-specific-variables.yml
  - ${{ each artifact in parameters.Artifacts }}:
    - task: Powershell@2
      inputs:
        filePath: $(Build.SourcesDirectory)/eng/common/scripts/Verify-ChangeLog.ps1
        arguments: >
          -PackageName ${{artifact.name}}
          -ServiceName ${{ parameters.ServiceName }}
          -RepoRoot $(Build.SourcesDirectory)
          -Language $(Language)
          -ForRelease ${{ coalesce(parameters.ForRelease, '$(IsReleaseRun)', 'False') }}
        pwsh: true
        workingDirectory: $(Pipeline.Workspace)
      displayName: Verify ChangeLogEntry for ${{artifact.name}}
      continueOnError: false
