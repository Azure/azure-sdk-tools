{"testcase": "Brownfield TypeSpec migration", "query": "title: Brownfield TypeSpec migration\n\nquestion: Hi, Is there a timeframe for existing brownfield RPs to move from OpenAPI swagger to TypeSpec.  Is it possible to mix TypeSpec with handwritten swagger and migrate in phases. Say for example migrate one resource type at a time to minimize risk.", "ground_truth": "Migration to TypeSpec for existing services is not yet mandatory, but it is suggested, and teams should be planning for it in Bromine and Krypton\nServices must wholly switch to TypeSpec, there is no allowed mixing of hand-written and generated swagger\nServicesmust conform to a single, unified api-version for their service, servicesthat currently use different api-versions for parts of their service are going to need to plan for conformance -this either means SDK splitting or version uniformity.  Teams that use this 'different api-versions for different resources in the same sdk' pattern are not good candidates for conversion at the moment\nIn generally, the more compliant your service is to the RPC and best practices, the easier conversion will be\nThere is documentation on converting here: [Getting started | TypeSpec Azure](https://azure.github.io/typespec-azure/docs/migrate-swagger/01-get-started/)", "expected_knowledges": [{"title": "Brownfield TypeSpec migration", "link": ""}, {"title": "What is OpenAPI?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-openapi"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Brownfield TypeSpec migration", "link": ""}, {"title": "Create or update an Azure REST API spec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-specs"}, {"title": "Create a high-level REST API design", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-design"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "OpenAPI3 to TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "Modify/rename @resource(s)", "link": ""}, {"title": "Migrate data-plane specs", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/checklists/migrate-dp-tips"}, {"title": "Understanding the OpenAPI Changes", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/mustread"}, {"title": "After migration - in data-plane/DynamicSessions/tspconfig.yaml", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Resolving-Folder-Migration-Conflicts:-A-Guide-for-PR-Authors"}, {"title": "Resolving OpenAPI Breaking Change Violations", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Getting started with TypeSpec migration", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/01-get-started"}, {"title": "Introduction", "link": "https://azure.github.io/typespec-azure/docs/intro"}, {"title": "Deep-dive into breaking changes on spec PRs", "link": "https://eng.ms/docs/products/azure-developer-experience/design/specs-pr-guides/pr-brch-deep"}, {"title": "Use tools to create and validate Azure REST APIs specs", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-tooling"}, {"title": "Azure REST API, SDK development process with TypeSpec", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Azure-REST-API,-SDK-development-process-with-TypeSpec"}, {"title": "Azure Service Versioning Guide", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Azure-Service-Versioning-Guideline"}, {"title": "change default ErrorResponse to customized ErrorResponse", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}], "expected_references": [{"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Create or update an Azure REST API spec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-specs"}, {"title": "Brownfield TypeSpec migration", "link": ""}]}
{"testcase": "Unable to apply client flatten to a top level resource property.", "query": "title: Unable to apply client flatten to a top level resource property.\n\nquestion: my existing open api spec, of a proxy resource is such\n```\n\"ArcSetting\": {\n\"description\": \"ArcSetting details.\",\n\"type\": \"object\",\n\"allOf\": [\n{\n\"$ref\": \"../../../../../../common-types/resource-management/v5/types.json#/definitions/ProxyResource\"\n}\n],\n\"properties\": {\n\"properties\": {\n\"description\": \"ArcSetting properties.\",\n\"$ref\": \"#/definitions/ArcSettingProperties\",\n\"x-ms-client-flatten\": true\n}\n}\n},\n```\nTo convert it to typespec, here is what my tsp looks\n```\n/**\n* ArcSetting details.\n*/\n@parentResource(Cluster)\nmodel ArcSetting is Azure.ResourceManager.ProxyResource<ArcSettingProperties> {\n...ResourceNameParameter<\nResource = ArcSetting,\nKeyName = \"arcSettingName\",\nSegmentName = \"arcSettings\",\nNamePattern = \"\"\n>;\n}\n```\nthe output is missing, the client-flatten property\n```\n\"ArcSetting\": {\n\"type\": \"object\",\n\"description\": \"ArcSetting details.\",\n\"properties\": {\n\"properties\": {\n\"$ref\": \"#/definitions/ArcSettingProperties\",\n\"description\": \"ArcSetting properties.\"\n}\n},\n\"allOf\": [\n{\n\"$ref\": \"../../../../../../common-types/resource-management/v6/types.json#/definitions/ProxyResource\"\n}\n]\n},\n```\nIs there a possible way to add this flag, or what is the implication for the existing SDK", "ground_truth": "Add\n@@Azure.ClientGenerator.Core.Legacy.flattenProperty(ArcSettings.propeties)\nBy convention put this in a back-compatible.tsp file.", "expected_knowledges": [{"title": "Convert the Resource Model to a form without properties", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "required;[\"id\", \"name\"]missing", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "additionalÂ  \"x-ms-client-flatten\": true", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Extend ResourceModelWithAllowedPropertySet", "link": ""}, {"title": "no-openapi", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-openapi"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "Understanding the OpenAPI Changes", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/mustread"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "OpenAPI3 to TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "Changing Property to Optional with Default", "link": ""}, {"title": "Brownfield TypeSpec migration", "link": ""}, {"title": "OpenAPI v3 emitter", "link": "https://typespec.io/docs/emitters/openapi3/openapi"}, {"title": "OpenAPI3 to TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "Generated Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Guideline for Client Emitter", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/guideline"}, {"title": "Usages for Illustrates the model flatten cases.", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/client-generator-core/flatten-property/main.tsp"}, {"title": "Decorators", "link": "https://typespec.io/docs/libraries/xml/reference/decorators"}], "expected_references": [{"title": "Decorators and their alternatives", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-openapi"}, {"title": "Generated Types - Flattening", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Usages for Illustrates the model flatten cases.", "link": "https://github.com/Azure/typespec-azure/blob/main/packages/azure-http-specs/specs/azure/client-generator-core/flatten-property/main.tsp"}]}
