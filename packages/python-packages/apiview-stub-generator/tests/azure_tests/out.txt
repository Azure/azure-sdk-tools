============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-8.4.2, pluggy-1.6.0
rootdir: /home/swathip/repos/azure-sdk-tools/packages/python-packages/apiview-stub-generator
plugins: anyio-4.11.0
collected 3 items

azure_test.py F

=================================== FAILURES ===================================
_____ TestApiViewAzure.test_sdks[azure-ai-documentintelligence_1.0.1[whl]] _____

self = <azure_test.TestApiViewAzure object at 0x7ea3122b5ed0>
pkg_name = 'azure-ai-documentintelligence', version = '1.0.1'
directory = 'documentintelligence'
pkg_namespace = 'azure.ai.documentintelligence', pkg_type = 'whl'

    @mark.parametrize("pkg_name,version,directory,pkg_namespace,pkg_type", SDK_PARAMS, ids=SDK_IDS)
    def test_sdks(self, pkg_name, version, directory, pkg_namespace, pkg_type):
        print("Pip freeze before test")
        check_call(["pip", "freeze"])
        pkg_path, mapping_file = self._download_packages(directory, pkg_name, version, pkg_type)
        temp_path = tempfile.gettempdir()
        # Explicitly pass through mapping file path
        stub_gen = StubGenerator(
            pkg_path=pkg_path, temp_path=temp_path, out_path=temp_path, mapping_path=mapping_file
        )
        apiview = self._write_tokens(stub_gen)
        self._validate_line_ids(apiview)
    
        assert apiview.package_name == pkg_name
        assert apiview.namespace == pkg_namespace
        # Compare the generated token file with the provided token file
        outfile = f"{pkg_name}_python.json"
        generated_token_file = os.path.join(temp_path, outfile)
        provided_token_file = os.path.abspath(os.path.join(os.path.dirname(__file__), f"token_files/{outfile}"))
    
>       self._diff_token_file(provided_token_file, generated_token_file)

azure_test.py:304: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <azure_test.TestApiViewAzure object at 0x7ea3122b5ed0>
old_file = '/home/swathip/repos/azure-sdk-tools/packages/python-packages/apiview-stub-generator/tests/azure_tests/token_files/azure-ai-documentintelligence_python.json'
new_file = '/tmp/azure-ai-documentintelligence_python.json'

    def _diff_token_file(self, old_file, new_file):
        """
        Compare two token JSON files and return the differences.
        """
        with open(old_file, 'r') as f1, open(new_file, 'r') as f2:
            old_tokens = json.load(f1)
            new_tokens = json.load(f2)
    
            # Replace "ParserVersion" value with "x.x.x"
            old_tokens["ParserVersion"] = "x.x.x"
            new_tokens["ParserVersion"] = "x.x.x"
            # Replace the GLOBAL header value ("# Package is parsed using apiview-stub-generator(version:0.3.17), Python version: 3.10.12") which may differ.
            old_tokens["ReviewLines"][0]["Tokens"][0]["Value"] = "Package is parsed using apiview-stub-generator(version:x.x.x), Python version: x.x.x"
            new_tokens["ReviewLines"][0]["Tokens"][0]["Value"] = "Package is parsed using apiview-stub-generator(version:x.x.x), Python version: x.x.x"
    
>           assert old_tokens == new_tokens, "Generated token file does not match the provided token file."
E           AssertionError: Generated token file does not match the provided token file.
E           assert {'Diagnostics... '1.0.1', ...} == {'Diagnostics... '1.0.1', ...}
E             
E             Omitting 5 identical items, use -vv to show
E             Differing items:
E             {'Diagnostics': []} != {'Diagnostics': [{'HelpLinkUri': 'https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations...', 'Text': 'The enum must inherit from CaseInsensitiveEnumMeta. [enum-must-inherit-case-insensitive-enum-meta]'}, ...]}
E             Use -v to get more diff

azure_test.py:267: AssertionError
----------------------------- Captured stdout call -----------------------------
Pip freeze before test
aiohappyeyeballs==2.6.1
aiohttp==3.12.15
aiosignal==1.4.0
alabaster==1.0.0
anyio==4.11.0
apistubgentest @ file:///tmp/tmpfeersoge/apistubgentest-copied
-e git+https://github.com/swathipil/azure-sdk-tools.git@db714c8522cb80657b294e8b8c09348a2ce40e2e#egg=apiview_stub_generator&subdirectory=packages/python-packages/apiview-stub-generator
astroid==3.3.8
async-timeout==5.0.1
attrs==25.3.0
azure-ai-documentintelligence @ file:///tmp/tmpk3m31lee/azure_ai_documentintelligence-1.0.1.tar.gz
azure-ai-voicelive @ file:///home/swathip/repos/azure-sdk-for-python/sdk/ai/azure-ai-voicelive
azure-core @ file:///tmp/tmp6ipoeb7y/azure_core-1.32.0.tar.gz
azure-eventhub==5.15.0
azure-eventhub-checkpointstoreblob @ file:///tmp/tmpet0h3ur7/azure-eventhub-checkpointstoreblob
azure-eventhub-checkpointstoreblob-aio @ file:///tmp/tmp0h65pn0z/azure_eventhub_checkpointstoreblob_aio-1.2.0.tar.gz
azure-healthinsights-radiologyinsights==1.1.0
azure-pylint-guidelines-checker==0.5.6
azure-schemaregistry @ file:///home/swathip/repos/azure-sdk-for-python/sdk/schemaregistry/azure-schemaregistry
babel==2.17.0
build==1.2.2.post1
cachetools==6.2.0
certifi==2025.8.3
cffi==2.0.0
chardet==5.2.0
charset-normalizer==3.4.1
colorama==0.4.6
commonmark==0.9.1
cryptography==46.0.2
dill==0.3.9
distlib==0.4.0
docutils==0.21.2
exceptiongroup==1.3.0
filelock==3.19.1
frozenlist==1.7.0
h11==0.16.0
httpcore==1.0.9
httpx==0.28.1
idna==3.10
imagesize==1.4.1
importlib_metadata==8.7.0
iniconfig==2.1.0
isodate==0.6.1
isort==5.13.2
Jinja2==3.1.6
lazy-object-proxy==1.10.0
MarkupSafe==3.0.3
mccabe==0.7.0
multidict==6.6.4
numpy==2.2.6
opentelemetry-api==1.37.0
outcome==1.3.0.post0
packaging==25.0
pandas==2.3.3
pkginfo==1.12.1.2
platformdirs==4.3.6
pluggy==1.6.0
propcache==0.3.2
pycparser==2.23
Pygments==2.19.2
pylint==3.3.6
pyproject-api==1.9.1
pyproject_hooks==1.2.0
pytest==8.4.2
python-dateutil==2.9.0.post0
pytz==2025.2
recommonmark==0.7.1
requests==2.32.5
six==1.17.0
sniffio==1.3.1
snowballstemmer==3.0.1
sortedcontainers==2.4.0
Sphinx==8.1.3
sphinx-rtd-theme==3.0.2
sphinxcontrib-applehelp==2.0.0
sphinxcontrib-devhelp==2.0.0
sphinxcontrib-htmlhelp==2.1.0
sphinxcontrib-jquery==4.1
sphinxcontrib-jsmath==1.0.1
sphinxcontrib-qthelp==2.0.0
sphinxcontrib-serializinghtml==2.0.0
tomli==2.2.1
tomlkit==0.13.2
tox==4.30.2
trio==0.31.0
typing_extensions==4.15.0
tzdata==2025.2
urllib3==2.5.0
virtualenv==20.34.0
wrapt==1.17.2
yarl==1.20.1
zipp==3.23.0
Error downloading https://raw.githubusercontent.com/Azure/azure-sdk-for-python/azure-ai-documentintelligence_1.0.1/sdk/documentintelligence/azure-ai-documentintelligence/apiview-properties.json: 404 Client Error: Not Found for url: https://raw.githubusercontent.com/Azure/azure-sdk-for-python/azure-ai-documentintelligence_1.0.1/sdk/documentintelligence/azure-ai-documentintelligence/apiview-properties.json
Wheel file downloaded to: /tmp/tmpoodvv0bf/azure_ai_documentintelligence-1.0.1-py3-none-any.whl
[
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "AnalyzeOutputOption",
        "line": 13,
        "column": 0,
        "endLine": 13,
        "endColumn": 25,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "ContentSourceKind",
        "line": 22,
        "column": 0,
        "endLine": 22,
        "endColumn": 23,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentAnalysisFeature",
        "line": 35,
        "column": 0,
        "endLine": 35,
        "endColumn": 29,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentBarcodeKind",
        "line": 54,
        "column": 0,
        "endLine": 54,
        "endColumn": 25,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentBuildMode",
        "line": 93,
        "column": 0,
        "endLine": 93,
        "endColumn": 23,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentContentFormat",
        "line": 102,
        "column": 0,
        "endLine": 102,
        "endColumn": 27,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentFieldType",
        "line": 112,
        "column": 0,
        "endLine": 112,
        "endColumn": 23,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentFontStyle",
        "line": 147,
        "column": 0,
        "endLine": 147,
        "endColumn": 23,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentFontWeight",
        "line": 156,
        "column": 0,
        "endLine": 156,
        "endColumn": 24,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentFormulaKind",
        "line": 165,
        "column": 0,
        "endLine": 165,
        "endColumn": 25,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentIntelligenceOperationStatus",
        "line": 174,
        "column": 0,
        "endLine": 174,
        "endColumn": 41,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentSelectionMarkState",
        "line": 191,
        "column": 0,
        "endLine": 191,
        "endColumn": 32,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentSignatureType",
        "line": 201,
        "column": 0,
        "endLine": 201,
        "endColumn": 27,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "DocumentTableCellKind",
        "line": 210,
        "column": 0,
        "endLine": 210,
        "endColumn": 27,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "LengthUnit",
        "line": 225,
        "column": 0,
        "endLine": 225,
        "endColumn": 16,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "OperationKind",
        "line": 236,
        "column": 0,
        "endLine": 236,
        "endColumn": 19,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "ParagraphRole",
        "line": 253,
        "column": 0,
        "endLine": 253,
        "endColumn": 19,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "SplitMode",
        "line": 272,
        "column": 0,
        "endLine": 272,
        "endColumn": 15,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    },
    {
        "type": "convention",
        "module": "azure.ai.documentintelligence.models._enums",
        "obj": "StringIndexType",
        "line": 283,
        "column": 0,
        "endLine": 283,
        "endColumn": 21,
        "path": "/tmp/azure_ai_documentintelligence-1.0.1-py3-none-any/azure/ai/documentintelligence/models/_enums.py",
        "symbol": "enum-must-inherit-case-insensitive-enum-meta",
        "message": "The enum must inherit from CaseInsensitiveEnumMeta. See details: https://azure.github.io/azure-sdk/python_implementation.html#extensible-enumerations",
        "message-id": "C4747"
    }
]
=========================== short test summary info ============================
FAILED azure_test.py::TestApiViewAzure::test_sdks[azure-ai-documentintelligence_1.0.1[whl]]
========================= 1 failed in 90.68s (0:01:30) =========================
