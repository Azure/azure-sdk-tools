{"testcase": "Brownfield TypeSpec migration", "query": "title: Brownfield TypeSpec migration\n\nquestion: Hi, Is there a timeframe for existing brownfield RPs to move from OpenAPI swagger to TypeSpec.  Is it possible to mix TypeSpec with handwritten swagger and migrate in phases. Say for example migrate one resource type at a time to minimize risk.", "ground_truth": "Migration to TypeSpec for existing services is not yet mandatory, but it is suggested, and teams should be planning for it in Bromine and Krypton\nServices must wholly switch to TypeSpec, there is no allowed mixing of hand-written and generated swagger\nServicesmust conform to a single, unified api-version for their service, servicesthat currently use different api-versions for parts of their service are going to need to plan for conformance -this either means SDK splitting or version uniformity.  Teams that use this 'different api-versions for different resources in the same sdk' pattern are not good candidates for conversion at the moment\nIn generally, the more compliant your service is to the RPC and best practices, the easier conversion will be\nThere is documentation on converting here: [Getting started | TypeSpec Azure](https://azure.github.io/typespec-azure/docs/migrate-swagger/01-get-started/)", "expected_knowledges": [{"title": "Brownfield TypeSpec migration", "link": ""}, {"title": "Brownfield TypeSpec migration", "link": ""}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "What is OpenAPI?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-openapi"}, {"title": "Create or update an Azure REST API spec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-specs"}, {"title": "Create a high-level REST API design", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-design"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "Modify/rename @resource(s)", "link": ""}, {"title": "OpenAPI3 to TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "Understanding the OpenAPI Changes", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/mustread"}, {"title": "Migrate data-plane specs", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/checklists/migrate-dp-tips"}, {"title": "Resolving OpenAPI Breaking Change Violations", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Getting started with TypeSpec migration", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/01-get-started"}, {"title": "What is TypeSpec?", "link": "https://azure.github.io/typespec-azure/docs/typespec-getting-started"}, {"title": "Resolving Folder Migration Conflicts: A Guide for PR Authors", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Resolving-Folder-Migration-Conflicts:-A-Guide-for-PR-Authors"}, {"title": "Resolving Pipeline Failures", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/pipeline"}], "expected_references": [{"title": "Brownfield TypeSpec migration", "link": ""}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Create or update an Azure REST API spec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-specs"}]}
{"testcase": "Unable to apply client flatten to a top level resource property.", "query": "title: Unable to apply client flatten to a top level resource property.\n\nquestion: my existing open api spec, of a proxy resource is such\n```\n\"ArcSetting\": {\n\"description\": \"ArcSetting details.\",\n\"type\": \"object\",\n\"allOf\": [\n{\n\"$ref\": \"../../../../../../common-types/resource-management/v5/types.json#/definitions/ProxyResource\"\n}\n],\n\"properties\": {\n\"properties\": {\n\"description\": \"ArcSetting properties.\",\n\"$ref\": \"#/definitions/ArcSettingProperties\",\n\"x-ms-client-flatten\": true\n}\n}\n},\n```\nTo convert it to typespec, here is what my tsp looks\n```\n/**\n* ArcSetting details.\n*/\n@parentResource(Cluster)\nmodel ArcSetting is Azure.ResourceManager.ProxyResource<ArcSettingProperties> {\n...ResourceNameParameter<\nResource = ArcSetting,\nKeyName = \"arcSettingName\",\nSegmentName = \"arcSettings\",\nNamePattern = \"\"\n>;\n}\n```\nthe output is missing, the client-flatten property\n```\n\"ArcSetting\": {\n\"type\": \"object\",\n\"description\": \"ArcSetting details.\",\n\"properties\": {\n\"properties\": {\n\"$ref\": \"#/definitions/ArcSettingProperties\",\n\"description\": \"ArcSetting properties.\"\n}\n},\n\"allOf\": [\n{\n\"$ref\": \"../../../../../../common-types/resource-management/v6/types.json#/definitions/ProxyResource\"\n}\n]\n},\n```\nIs there a possible way to add this flag, or what is the implication for the existing SDK", "ground_truth": "Add\n@@Azure.ClientGenerator.Core.Legacy.flattenProperty(ArcSettings.propeties)\nBy convention put this in a back-compatible.tsp file.", "expected_knowledges": [{"title": "Convert the Resource Model to a form without properties", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "required;[\"id\", \"name\"]missing", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "additional  \"x-ms-client-flatten\": true", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Extend ResourceModelWithAllowedPropertySet", "link": ""}, {"title": "no-openapi", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-openapi"}, {"title": "no-openapi", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-openapi"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "Understanding the OpenAPI Changes", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/mustread"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "OpenAPI3 to TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "OpenAPI3 to TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "Resolving OpenAPI Breaking Change Violations", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Brownfield TypeSpec migration", "link": ""}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "Guideline for Client Emitter", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/guideline"}, {"title": "TypeSpec ARM Interface Mapping to Swagger Documentation", "link": ""}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "Decorators", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/reference/decorators"}, {"title": "TypeSpec Azure.ResourceManager.Foundations Models Mapping to Swagger Documentation", "link": ""}, {"title": "TypeSpec ARM Interface Mapping to Swagger Documentation", "link": ""}], "expected_references": [{"title": "Guideline for Client Emitter", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/guideline"}, {"title": "no-openapi", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-openapi"}, {"title": "additional  \"x-ms-client-flatten\": true", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}]}
