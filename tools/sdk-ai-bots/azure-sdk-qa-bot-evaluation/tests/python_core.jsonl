{"testcase": "Python Live Test for async api", "query": "title: Python Live Test for async api\n\nquestion: Hello Language - Python,\nWe at Callautomation are working on adding live tests for the async APIs. When I tried to run a live test, I encountered an SSL certificate issue, as shown below. Could you help me understand what I might be missing?\n```\nexcept aiohttp.client_exceptions.ClientError as err:\n>           raise ServiceRequestError(err, error=err) from err\nE           azure.core.exceptions.ServiceRequestError: Cannot connect to host localhost:5001 ssl:True [SSLCertVerificationError: (1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self-signed certificate (_ssl.c:1028)')]\nC:\\Users\\v-dharmarajv\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\azure\\core\\pipeline\\transport\\_aiohttp.py:364: ServiceRequestError\n```", "ground_truth": "You're encountering an SSL certificate error when running live tests for async APIs, specifically when connecting to https://localhost:5001. This is the test proxy endpoint, and the error is likely due to certificate verification failing. Although the same code works for another team member, the issue may be caused by environment variables — either missing or incorrectly set.\nTo run live tests, make sure AZURE_TEST_RUN_LIVE is set to \"true\". If you also want to record, avoid setting AZURE_SKIP_LIVE_RECORDING. As a workaround for the SSL issue, set the environment variable PROXY_URL to http://localhost:5000 instead of using HTTPS. This bypasses certificate validation and resolves the issue.", "expected_knowledges": [{"title": "Python SDK advanced testing guide", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/tests-advanced.md"}, {"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}, {"title": "Python Guidelines: Implementation", "link": "https://azure.github.io/azure-sdk/python_implementation.html"}, {"title": "Python SDK testing guide", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/tests.md"}, {"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}, {"title": "Run SDK tests", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/dev_setup.md"}, {"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}, {"title": "Debugging Live Tests", "link": "https://dev.azure.com/azure-sdk/internal/_wiki/wikis/internal.wiki?wikiVersion=GBwikiMaster&pagePath=/Engineering-System/Testing-Guidelines"}, {"title": "Using your Client's `send_request` Method", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/send_request.md"}, {"title": "Azure SDK for Python - Engineering System", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/eng_sys_checks.md"}, {"title": "Asynchronous API Reference", "link": "https://github.com/cloud-and-ai-microsoft/resource-provider-contract/blob/master/v1.0/async-api-reference.md"}, {"title": "Decorators", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/reference/decorators"}, {"title": "Deprecating Azure SDKs", "link": "https://eng.ms/docs/products/azure-developer-experience/retirement/sdk-deprecation"}, {"title": "Python Guidelines: API Design", "link": "https://azure.github.io/azure-sdk/python_design.html"}, {"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}, {"title": "Python Guidelines: API Design", "link": "https://azure.github.io/azure-sdk/python_design.html"}, {"title": "Decorators", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/reference/decorators"}, {"title": "Python SDK testing guide", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/tests.md"}, {"title": "Overview", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/tests.md"}, {"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}, {"title": "The perfstress framework", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/perfstress_tests.md"}, {"title": "Python Guidelines: Implementation", "link": "https://azure.github.io/azure-sdk/python_implementation.html"}, {"title": "Writing New Tests", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Dataplane-Codegen-Quick-Start-for-Test"}, {"title": "Python SDK advanced testing guide", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/tests-advanced.md"}], "expected_references": [{"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}, {"title": "Python SDK advanced testing guide", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/tests-advanced.md"}]}
{"testcase": "release pipeline link for Python SDK `azure-mgmt-resource-bicep`", "query": "title: release pipeline link for Python SDK `azure-mgmt-resource-bicep`\n\nquestion: How to find the specific release pipeline link of Python SDK `azure-mgmt-resource-bicep` and it would be nicer if someone can provide me the link directly.", "ground_truth": "To find the specific release pipeline link for the Python SDK `azure-mgmt-resource-bicep`, you typically need to locate the corresponding pipeline in Azure DevOps under the internal Azure SDK project. The naming convention for the pipeline is usually `python - <servicedir>`, where `<servicedir>` matches the service directory (in this case, likely resource or resource-bicep).\nHere is the general process:\n1. Go to [Azure DevOps - Azure SDK Internal Project](https://dev.azure.com/azure-sdk/internal/_build)\n2. Search for the pipeline named `python - resource` or similar, as the pipeline is named according to the service directory for management SDKs.\n3. The direct link format for a service pipeline is: `https://dev.azure.com/azure-sdk/internal/_build?definitionId=<ID>&_a=summary`\n- You can search for `resource` in the pipelines list to locate the exact one.", "expected_knowledges": [{"title": "Step 4: Trigger a release", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/deprecation_process.md"}, {"title": "Generation of SDK", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/generation.md"}, {"title": "Developer Documentation", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/README.md"}, {"title": "Run release SDK pipeline", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-release/sdk-release-pipeline"}, {"title": "Deprecating Azure SDKs", "link": "https://eng.ms/docs/products/azure-developer-experience/retirement/sdk-deprecation"}, {"title": "Management Package Release", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/mgmt_release.md"}, {"title": "Release process", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/release.md"}, {"title": "Support", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Dataplane-Codegen-Quick-Start"}, {"title": "Prerequisites", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Dataplane-Codegen-Quick-Start"}, {"title": "NOTE REGARDING ARTIFACTS", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/release.md"}, {"title": "ESRP Release Process", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/esrp_release.md"}, {"title": "Management and ARM SDK documentation for developers", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/README.md"}, {"title": "Request an SDK Architecture Review", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-review"}, {"title": "Publish SDK reference docs", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-docs"}, {"title": "Publish SDK reference docs", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-docs"}, {"title": "Table of Contents", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/SDK-Validation"}, {"title": "Release process", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/release.md"}, {"title": "Azure REST API Specification Directory Structure", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Specification-Folder-Structure-Guide"}, {"title": "Necessary info about python SDK", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Generate-Python-Mgmt-SDK-from-Typespec"}, {"title": "Management and ARM SDK documentation for developers", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/README.md"}, {"title": "What to do after generating the SDK code", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Generate-Python-Mgmt-SDK-from-Typespec"}, {"title": "Step 4: Trigger a release", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/deprecation_process.md"}, {"title": "Create/Update the `ci.yml`", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/What-to-do-after-generating-the-SDK-code-with-codegen"}, {"title": "Documentation", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/README.md"}, {"title": "Release process", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/release.md"}, {"title": "Step 4: Trigger a release", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/deprecation_process.md"}, {"title": "Run release SDK pipeline", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-release/sdk-release-pipeline"}, {"title": "ESRP Release Process", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/esrp_release.md"}], "expected_references": [{"title": "Run release SDK pipeline", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-release/sdk-release-pipeline"}, {"title": "Release process", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/release.md"}, {"title": "Management Package Release", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/mgmt_release.md"}]}
{"testcase": "Python SDK gen failing on relative tsp path", "query": "title: Python SDK gen failing on relative tsp path\n\nquestion: This is my 1st time trying to create our Python SDK. The pipeline appears to be failing due to relative paths for included tsp files. Any idea how to get around this?\n```\nErrors occurred while generating SDK from specification/discoverydev/Discovery.Workspace/tspconfig.yaml. Follow the steps at https://aka.ms/azsdk/sdk-automation-faq#how-to-view-the-detailed-sdk-generation-errors to view detailed errors.\n2025-10-08 16:27:29 [ERROR] ====== Error occurred in tsp compiler (error stack start) ======\n2025-10-08 16:27:29 [ERROR] /mnt/vss/_work/1/s/azure-sdk-for-python-pr/sdk/discovery-workspace/azure-discovery-workspace/TempTypeSpecFiles/Discovery.Workspace/common.tsp:1:1 - error import-not-found: Couldn't resolve import \"../Discovery.Shared/namespace.tsp\"\n2025-10-08 16:27:29 [ERROR] /mnt/vss/_work/1/s/azure-sdk-for-python-pr/sdk/discovery-workspace/azure-discovery-workspace/TempTypeSpecFiles/Discovery.Workspace/common.tsp:3:1 - error import-not-found: Couldn't resolve import \"../Discovery.Shared/data-plane.tsp\"\n2025-10-08 16:27:29 [ERROR] /mnt/vss/_work/1/s/azure-sdk-for-python-pr/sdk/discovery-workspace/azure-discovery-workspace/TempTypeSpecFiles/Discovery.Workspace/common.tsp:4:1 - error import-not-found: Couldn't resolve import \"../Discovery.Shared/shared.tsp\"\n2025-10-08 16:27:29 [ERROR] /mnt/vss/_work/1/s/azure-sdk-for-python-pr/sdk/discovery-workspace/azure-discovery-workspace/TempTypeSpecFiles/Discovery.Workspace/_project.tsp:5:1 - error import-not-found: Couldn't resolve import \"../Discovery.Shared/data-plane.tsp\"\n2025-10-08 16:27:29 [ERROR] /mnt/vss/_work/1/s/azure-sdk-for-python-pr/sdk/discovery-workspace/azure-discovery-workspace/TempTypeSpecFiles/Discovery.Workspace/_conversation_message_logs.tsp:6:1 - error import-not-found: Couldn't resolve import \"../Discovery.Shared/data-plane.tsp\"\n2025-10-08 16:27:29 [ERROR] /mnt/vss/_work/1/s/azure-sdk-for-python-pr/sdk/discovery-workspace/azure-discovery-workspace/TempTypeSpecFiles/Discovery.Workspace/_tool.tsp:5:1 - error import-not-found: Couldn't resolve import \"../Discovery.Shared/data-plane.tsp\"\n2025-10-08 16:27:29 [ERROR] /mnt/vss/_work/1/s/azure-sdk-for-python-pr/sdk/discovery-workspace/azure-discovery-workspace/TempTypeSpecFiles/Discovery.Workspace/_tool.tsp:6:1 - error import-not-found: Couldn't resolve import \"../Discovery.Shared/shared.tsp\"\n```", "ground_truth": "According to error log, it seems that your typespec refer to folder outside project folder but you don't declare it in `tspconfig.yaml`. You could add the missing dir like below then try again:\n```\n\"@azure-tools/typespec-client-generator-cli\":\nadditionalDirectories:\n- \"specification/keyvault/Security.KeyVault.Common/\"\n```", "expected_knowledges": [{"title": "TypeSpec SDK Generation - Getting Started", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/ai/typespec_generation.md"}, {"title": "SDK Generation failure", "link": ""}, {"title": "TypeSpec SDK Generation - Getting Started", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/ai/typespec_generation.md"}, {"title": "SDK generation configuration", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-spec-gen-sdk-config"}, {"title": "Configuration", "link": "https://typespec.io/docs/handbook/configuration/configuration"}, {"title": "What to do after generating the SDK code", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Generate-Python-Mgmt-SDK-from-Typespec"}, {"title": "TypeSpec SDK Generation - Getting Started", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/ai/typespec_generation.md"}, {"title": "missing externalDocs", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "add \"@azure-tools/typespec-python\" to your package.json to generate Python code", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/00howtogen"}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "add missing location path parameter", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "rename duplicated model `Resource`", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Overview", "link": "https://azure.github.io/typespec-azure/docs/emitters/clients/typespec-python/reference/index"}, {"title": "Configuration", "link": "https://typespec.io/docs/handbook/configuration/configuration"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "After migration - in data-plane/DynamicSessions/tspconfig.yaml", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Resolving-Folder-Migration-Conflicts:-A-Guide-for-PR-Authors"}, {"title": "Emitter usage", "link": "https://azure.github.io/typespec-azure/docs/emitters/clients/typespec-python/reference/emitter"}, {"title": "add \"@azure-tools/typespec-ts\" to your package.json to generate Typescript code", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/00howtogen"}, {"title": "OpenAPI3 to TypeSpec", "link": "https://typespec.io/docs/emitters/openapi3/cli"}, {"title": "Table of Contents", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/SDK-Validation"}, {"title": "Usage", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-with-tsp-client/intro_tsp_client"}, {"title": "What to do after generating the SDK code", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Generate-Python-Mgmt-SDK-from-Typespec"}, {"title": "Namespaces", "link": "https://typespec.io/docs/emitters/clients/http-client-python/reference/package-structure"}, {"title": "Creating a TypeSpec Library", "link": "https://typespec.io/docs/extending-typespec/basics"}, {"title": "Azure Python SDK Breaking Changes Review and Resolution Guide for TypeSpec Migration", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/sdk-breaking-changes-guide.md"}, {"title": "Typespec Validation required check", "link": ""}, {"title": "Imports", "link": "https://typespec.io/docs/language-basics/imports"}, {"title": "SDK Generation failure", "link": ""}], "expected_references": [{"title": "SDK-Validation.md", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/SDK-Validation"}, {"title": "Usage", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-with-tsp-client/intro_tsp_client"}]}
{"testcase": "MS Learning Documentation Categorization as \"Unknown\"", "query": "title: MS Learning Documentation Categorization as \"Unknown\"\n\nquestion: I've released the preview version of azure-ai-transcription (v1.0.0b1), but the documentation is appearing under the \"unknown\" folder on Microsoft Learn instead of the cognitive-services category.\nDuring the documentation build, the warning shows:\n```\nThe service of package: cognitiveservices\n```\nCan someone help take a look of this issue? Does it require register this package in the metadata CSV with MSDocService: cognitive-services so the documentation appears in the correct location on Microsoft Learn?\nHere is the release [pipeline link: Pipelines - Run 20251203.2](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5633753&view=results)\nHere is MS learning link: [Azure AI Speech Transcription client library for Python | Microsoft Learn](https://learn.microsoft.com/en-us/python/api/overview/azure/ai-transcription-readme?view=azure-python-preview)", "ground_truth": "Yes, to ensure the documentation for azure-ai-transcription appears under the \"cognitive-services\" category on Microsoft Learn, you need to add or update the metadata for this package in the metadata CSV file located at https://github.com/Azure/azure-sdk/blob/main/_data/releases/latest/python-packages.csv.\nSpecifically, you should:\n1. Find (or add) the row for azure-ai-transcription in python-packages.csv.\n2. Set the MSDocService field to \"cognitive-services\". This value is used to correctly categorize the package in the Learn docs hierarchy.\n3. Ensure other relevant fields (ServiceName, DisplayName, Type, etc.) are filled in appropriately.\nAfter updating the CSV, commit and create a PR in the azure-sdk repo. Once merged, the next docs build will pick up the new metadata and your package will be categorized correctly.\nIf the Notes field for your package is set to \"Needs Review\", update it to another value to avoid automation overwriting your changes.\nReferences and field details can be found here:\n- [CSV field README](https://github.com/Azure/azure-sdk/blob/main/eng/README.md#csv-fields)\n- [Relevant CSV file for Python packages](https://github.com/Azure/azure-sdk/blob/main/_data/releases/latest/python-packages.csv)\nIn summary: Yes, registering your package in the metadata CSV with MSDocService: cognitive-services is required. This action will resolve the warning and correct the Learn categorization.\n**References**\n[Publish SDK reference docs / Onboard a released package | Azure-sdk-docs-eng](https://eng.ms/docs/products/azure-developer-experience/develop/sdk-docs)\n[Metadata CSV update process for Python | Azure Sdk For Python Docs](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/deprecation_process.md)", "expected_knowledges": [{"title": "Publish SDK reference docs", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-docs"}, {"title": "Troubleshooting REST API documentation", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-docs-troubleshooting"}, {"title": "", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Home"}, {"title": "Step 6: Update API Documentation", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/deprecation_process.md"}, {"title": "Versions", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Folder-Structure"}, {"title": "Management Package Release", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/mgmt_release.md"}, {"title": "missing externalDocs", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "no-openapi", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-openapi"}, {"title": "Overview", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Folder-Structure"}, {"title": "Unknown decorator @flattenProperty", "link": ""}, {"title": "", "link": "https://dev.azure.com/azure-sdk/internal/_wiki/wikis/internal.wiki?wikiVersion=GBwikiMaster&pagePath=/Engineering-System/Testing-Guidelines"}, {"title": "", "link": "https://dev.azure.com/azure-sdk/internal/_wiki/wikis/internal.wiki?wikiVersion=GBwikiMaster&pagePath=/Engineering-System/Pipelines/Azure-DevOps-Pipeline-Guidance"}, {"title": "How to define a preview version", "link": "https://azure.github.io/typespec-azure/docs/howtos/versioning/preview-version"}, {"title": "add missing location path parameter", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-portal-core/reference/data-types"}, {"title": "Editing", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/About-the-Wiki"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "PRLabel: %Your Service Label", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/supporting-sdk-customers/codeowners"}, {"title": "Problems and resolution", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/How-to-fix-CI"}, {"title": "Publish SDK reference docs", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-docs"}, {"title": "Deprecating Azure SDKs", "link": "https://eng.ms/docs/products/azure-developer-experience/retirement/sdk-deprecation"}, {"title": "Step 3: Create a PR", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/deprecation_process.md"}, {"title": "Troubleshooting REST API documentation", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-docs-troubleshooting"}], "expected_references": [{"title": "Publish SDK reference docs", "link": "https://eng.ms/docs/products/azure-developer-experience/develop/sdk-docs"}]}
{"testcase": "\"black\" job in pipeline fails, but when I run locally, the tool does not make any changes", "query": "title: \"black\" job in pipeline fails, but when I run locally, the tool does not make any changes\n\nquestion: I like to run the \"black\" tool before PRs, and I ask others in my project to do the same. A few hours ago I found out that I can turn on this check in the pipeline. I was happy to see this. So I added the following to pyproject.toml:\n```\n[tool.azure-sdk-build]\nblack = true\n```\nI run \"black\" before commiting my last change to the PR, and no updates were needed.\nBut the pipeline called out a \"black\" failure: https://dev.azure.com/azure-sdk/public/_build/results?buildId=5606772&view=logs&j=b70e5e73-bbb6-5567-0939-8415943fadb9&t=efe9ac6d-3fdb-50af-24e1-4319f36eecb4\nI see the pipeline used black version 24.4.0. I had a newer version when I run locally. I install 24.4.0 and run that, but it also did not do any changes to the code.\nAny idea how to fix it? (other than removing it from the pipeline...).", "ground_truth": "The \"black\" job in the Azure SDK for Python pipeline can fail for reasons beyond just code formatting. Even if running \"black\" locally with the same version (24.4.0) does not produce changes, there are a few areas to check for a root cause:\n1. Run Black with the Same Arguments as the Pipeline:The pipeline runs \"black\" using tox with specific arguments. Make sure you are running locally in the same way. From the official guidance, run: `tox run -e black -c ../../../eng/tox/tox.ini --root . -- .` This ensures that the same config files, paths, and excludes are used. The pipeline may use a different configuration or target files that you are not formatting locally. Or you can tried the same command used by ci: `python -m azpysdk.main black --isolate sdk/ai/azure-ai-projects`.\n2. Check for Hidden Files or Config Differences: The pipeline uses the repository’s configuration, including pyproject.toml and any exclude/include patterns. Local runs may inadvertently skip files due to local ignore files, environment differences, or working directory mismatches. Double-check that your local environment matches the CI context.\n3. Run `git status` or `git diff` to find out whether there are files already formatted but not pushed to the pr.\n4. Line Endings and Whitespace: Sometimes, black fails due to line ending differences (CRLF vs LF) or invisible whitespace issues that are not flagged locally. Make sure your files have consistent line endings (prefer LF in repo).\n5. Check the Pipeline Log for Specific Files: Review the pipeline's failure log closely to see which files are reported as needing formatting. Sometimes, it’s a file outside your typical working set (such as generated code or test files).\n6. Reproduce in a Clean Environment: To eliminate local state issues, clone your repo in a fresh directory and re-run the pipeline’s black command as above. If you confirm that running \"black\" via tox in a clean environment with the same version does not report changes, but the pipeline still fails, check for possible pipeline caching or artifact issues. Otherwise, use the pipeline log to identify exactly which file is causing the failure and focus on that file. Removing the check is not recommended; instead, focus on aligning your local runs with the pipeline invocation. If you continue to see unexplained failures, reach out in the Azure SDK language team channel with your findings and the specific pipeline log excerpt.", "expected_knowledges": [{"title": "Uniform Versioning Violation Guide", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Uniform-Versioning-Violation-Guide"}, {"title": "Known Issues", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado"}, {"title": "Azure SDK for Python - Engineering System", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/eng_sys_checks.md"}, {"title": "Resolving Pipeline Failures", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/pipeline"}, {"title": "OneBranch SDL", "link": "https://azure.github.io/typespec-azure/docs/troubleshoot/sdl"}, {"title": "Process", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Deprecating-Preview-APIs"}, {"title": "lack of  final-state-vis: azure-async-operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Quick Start", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-with-tsp-client/local_spec_quickstart"}, {"title": "Azure Versioning and Breaking Changes Policy V1.3.2", "link": ""}, {"title": "Error with invalid-argument Argument of type xxx is not assignable to parameter of type 'Azure.ResourceManager.CommonTypes.Resource'", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "error duplicate-property in @azure-tools/typespec-azure-resource-manager/lib tsp", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Step 3: Create a PR", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/deprecation_process.md"}, {"title": "Known Issues", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado"}, {"title": "TypeSpec Azure.ResourceManager.CommonTypes Models Mapping to Swagger Documentation", "link": ""}, {"title": "Table of Contents", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado"}, {"title": "Troubleshooting REST API documentation", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-docs-troubleshooting"}, {"title": "Build triggers", "link": "https://dev.azure.com/azure-sdk/internal/_wiki/wikis/internal.wiki?wikiVersion=GBwikiMaster&pagePath=/Engineering-System/Pipelines/Azure-DevOps-Pipeline-Guidance"}, {"title": "`ProvisioningStateMustBeReadOnly` lintdiff violation in TypeSpec for ARM Service", "link": "https://azure.github.io/typespec-azure/docs/troubleshoot/status-read-only-error"}, {"title": "Azure SDK for Python - Engineering System", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/eng_sys_checks.md"}, {"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}, {"title": "Typespec Validation required check", "link": ""}], "expected_references": [{"title": "Azure SDK for Python - Engineering System", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/eng_sys_checks.md"}, {"title": "Guide for test proxy troubleshooting", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/test_proxy_troubleshooting.md"}]}
{"testcase": "Python emitter issue with bulleted list TypeSpec doc string, and other", "query": "title: Python emitter issue with bulleted list TypeSpec doc string, and other\n\nquestion: This TypeSpec repo/branch/folder: https://github.com/Azure/azure-rest-api-specs-pr/tree/feature/ai-foundry/agents-v2/specification/ai/Azure.AI.Projects\nIs emitted into this Python repo/branch/folder: https://github.com/Azure/azure-sdk-for-python/tree/feature/azure-ai-projects/2.0.0b1/sdk/ai/azure-ai-projects\nUsing the command `tsp-client update --debug --local-spec-repo <path>`\nI have a green build, other than errors in the \"Build Docs\" stage, as seen in this build of the branc: https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5527867&view=results\nI need some guidance on how to update TypeSpec to make these Python doc generation go away.\nThe errors are the following:\n```\nupdating environment: [new config] 7 added, 0 changed, 0 removed\ndocstring of azure.ai.projects.models.Reasoning.generate_summary:6: WARNING: Inline strong start-string without end-string. [docutils]\ndocstring of azure.ai.projects.models.WorkflowDefinition.workflow:2: WARNING: Duplicate explicit target name: \"learn more\". [docutils]\ndocstring of azure.ai.projects.models.WorkflowDefinition.workflow:2: WARNING: Duplicate explicit target name: \"learn more\". [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:54: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:61: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:64: ERROR: Unexpected indentation. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:65: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:67: ERROR: Unexpected indentation. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:79: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:82: ERROR: Unexpected indentation. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:83: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:89: ERROR: Unexpected indentation. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:90: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:109: WARNING: Definition list ends without a blank line; unexpected unindent. [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._models.Response:112: ERROR: Unexpected indentation. [docutils]\ndocstring of azure.ai.projects.models.WorkflowDefinition.workflow:2: WARNING: Duplicate explicit target name: \"learn more\". [docutils]\ndocstring of azure.ai.projects.models.Response.output:10: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\ndocstring of azure.ai.projects.models.Response.output:12: WARNING: Definition list ends without a blank line; unexpected unindent. [docutils]\ndocstring of azure.ai.projects.models.Response.tools:9: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\ndocstring of azure.ai.projects.models.Response.tools:12: ERROR: Unexpected indentation. [docutils]\ndocstring of azure.ai.projects.models.Response.tools:13: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\ndocstring of azure.ai.projects.models.Response.truncation:8: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\ndocstring of azure.ai.projects.models.Response.truncation:11: ERROR: Unexpected indentation. [docutils]\ndocstring of azure.ai.projects.models.Response.truncation:12: WARNING: Block quote ends without a blank line; unexpected unindent. [docutils]\ndocstring of azure.ai.projects.models.WorkflowDefinition.workflow:2: WARNING: Duplicate explicit target name: \"learn more\". [docutils]\nE:\\src\\sdk-repos\\azure-sdk-for-python\\sdk\\ai\\azure-ai-projects\\.tox\\sphinx\\Lib\\site-packages\\azure\\ai\\projects\\models\\__init__.py:docstring of azure.ai.projects.models._enums.ServiceTier:4: WARNING: Bullet list ends without a blank line; unexpected unindent. [docutils]\n```\nIt comes from two TypeSpec models, direct link here:\nResponse model - https://github.com/Azure/azure-rest-api-specs-pr/blob/feature/ai-foundry/agents-v2/specification/ai/Azure.AI.Projects/.external-readonly/openai.external.typespec/responses/custom.tsp#L38\n```\nmodel Response {\n...Response_Pre_Update;\nconversation: {\nid: string;\n} | null;\n}\n```\nServiceTier union - https://github.com/Azure/azure-rest-api-specs-pr/blob/feature/ai-foundry/agents-v2/specification/ai/Azure.AI.Projects/.external-readonly/openai.external.typespec/common/models.tsp#L475\n```\nunion ServiceTier {\n\"auto\",\n\"default\",\n\"flex\",\n\"scale\",\n\"priority\",\n}\n```", "ground_truth": "The Sphinx docstring errors you're seeing in the generated Python SDK (unexpected indentation, block quote ends without a blank line, duplicate explicit target names, bullet/definition list issues) are caused by how TypeSpec documentation comments are emitted into Python docstrings, especially when those comments use Markdown or formatting that doesn't map cleanly to reStructuredText (reST), which Sphinx expects.\nTo resolve these errors, there are two possible solutions:\n1. You need to ensure that the TypeSpec doc comments for the Response model and ServiceTier union are written in a way that avoids problematic Markdown constructs and closely follows what Sphinx/reST expects.\nHere are practical steps:\n- **Bullet/Definition List Formatting:** - Avoid using Markdown bullet lists (`*`, `-`, or `+`) or definition lists in your TypeSpec doc comments. Instead, use plain sentences, or, if you need a list, format it as numbered items with clear line breaks between each item. - If you must use a list, add a blank line before and after the list, and ensure each item starts on a new line. Do not nest lists or use complex indentation.\n- **Inline Strong/Emphasis Markup:** - If you use `**bold**` or `*italic*` in TypeSpec comments, Sphinx may misinterpret these if not balanced. Prefer using plain text or ensure that every start marker has a matching end marker.\n- **Explicit Targets (Links):** - If you use `[Learn more](url)` in doc comments, emitting these into Python docstrings can result in duplicate explicit target names. Use plain URLs or avoid repeating the same anchor text multiple times.\n- **Block Quotes:** - Avoid using Markdown block quotes (`>`) in TypeSpec doc comments. If you need to highlight something, use plain sentences.\n- **Unexpected Indentation:** - Ensure all TypeSpec doc comments are left-aligned, with no leading spaces or tabs before the text, unless you are deliberately creating a code block. For code blocks, use triple backticks and add blank lines before and after the block.\n- **General Style:** - Write documentation in simple paragraphs. Do not mix Markdown with reST, and avoid complex formatting. - Example of a safe docstring for a model property: ```tsp /** * The list of available service tiers. Possible values include: * 1. Basic - Entry-level tier. * 2. Standard - Recommended for most workloads. * 3. Premium - Advanced tier for high throughput. */ ``` - Avoid: ```tsp /** * - Basic * - Standard * - Premium */ ``` **Actionable Steps:** - Go to your TypeSpec definitions for Response and ServiceTier, and revise any doc comments containing bullet lists, definition lists, block quotes, repeated anchor text, or excessive indentation. Replace with simple sentences or numbered lists as above. - After making these changes, regenerate the Python SDK and run the Sphinx build again. The warnings/errors should be resolved. - For reference on Python docstring formatting and Sphinx compatibility, see the Azure Python SDK [docstring guidelines](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/docstring.md). If you need a specific example for ServiceTier: ```tsp /** * Service tier for deployment. Possible values: * 1. Basic: Entry-level tier. * 2. Standard: Recommended tier. * 3. Premium: Advanced tier for large workloads. */ union ServiceTier { ... } ``` And for Response model, ensure any lists or references are in plain sentences and do not use block quotes or repeated links.\n2. Or you can disable the sphinx environment within the pyproject.toml for the problematic package. By that way you won't hit these sphinx failures.\n```\n[tool.azure-sdk-build]\nsphinx = false\n```", "expected_knowledges": [{"title": "Same response model is used both in pageable operation and non-pageable operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Documentation", "link": "https://typespec.io/docs/language-basics/documentation"}, {"title": "Output folder 'ContentUnderstanding' appears to contain TypeSpec-generated swagger files, not generated from the current TypeSpec sources. Perhaps you deleted a version from your TypeSpec, but didn't delete the associated swaggers?", "link": ""}, {"title": "Azure SDK Migration Guide: New Operation Design Generation Breaking Changes", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/operation_migration.md"}, {"title": "Client Emitters", "link": "https://typespec.io/docs/emitters/clients/introduction"}, {"title": "Azure SDK Migration Guide: New Hybrid Model Design Generation Breaking Changes", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/mgmt/hybrid_model_migration.md"}, {"title": "Emitter usage", "link": "https://azure.github.io/typespec-azure/docs/emitters/clients/typespec-python/reference/emitter"}, {"title": "Exclude property from list that is in create/update/get", "link": ""}, {"title": "Convert OpenAPI specs to TypeSpec", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec-conversion"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Additional \"consumes\": [  \"text/plain\"  ], in operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "VS Code Extension", "link": "https://typespec.io/docs/introduction/editor/vscode"}, {"title": "Azure REST API Specification Directory Structure", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Specification-Folder-Structure-Guide"}, {"title": "Client Emitters", "link": "https://typespec.io/docs/emitters/clients/introduction"}, {"title": "no-openapi", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-core/rules/no-openapi"}, {"title": "Generate Swagger and TypeSpec in Package", "link": "https://github.com/Azure/azure-sdk-for-python/wiki/Generate-Swagger-and-TypeSpec-in-Package"}, {"title": "Migrate data-plane specs", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/checklists/migrate-dp-tips"}, {"title": "TypeSpec Validation failed", "link": ""}, {"title": "Namespaces", "link": "https://typespec.io/docs/emitters/clients/http-client-python/reference/package-structure"}, {"title": "Emitter usage", "link": "https://azure.github.io/typespec-azure/docs/emitters/clients/typespec-ts/reference/emitter"}, {"title": "Basic methods", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/04method"}, {"title": "Is adding new value to enum is considered a breaking change?", "link": ""}, {"title": "Generated Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Type Literals", "link": "https://typespec.io/docs/language-basics/type-literals"}, {"title": "Decorators", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/reference/decorators"}, {"title": "Python SDK Static Type Checking Guide", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/static_type_checking.md"}, {"title": "Generated Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Type Literals", "link": "https://typespec.io/docs/language-basics/type-literals"}, {"title": "Generated Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "Documentation", "link": "https://typespec.io/docs/language-basics/documentation"}], "expected_references": [{"title": "Documentation", "link": "https://typespec.io/docs/language-basics/documentation"}, {"title": "Python SDK Static Type Checking Guide", "link": "https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/static_type_checking.md"}, {"title": "Comments", "link": "https://typespec.io/docs/language-basics/documentation"}]}
