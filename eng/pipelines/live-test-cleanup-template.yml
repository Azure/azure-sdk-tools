parameters:
  - name: DisplayName
    type: string
  - name: SubscriptionConfigurations
    type: object
    default:
      - $(sub-config-azure-cloud-test-resources)

steps:
  - template: /eng/common/TestResources/build-test-resource-config.yml
    parameters:
      SubscriptionConfigurations: ${{ parameters.SubscriptionConfigurations }}

  - pwsh: |
      $subscriptionConfiguration = @'
        $(SubscriptionConfiguration)
      '@ | ConvertFrom-Json -AsHashtable

      ./eng/scripts/live-test-resource-cleanup.ps1 `
      @subscriptionConfiguration `
      -WhatIf `
      -Verbose
    displayName: ${{ parameters.DisplayName }}
    continueOnError: true

