{"testcase": "In Resource provider, what is the type I should declare for an object or dictionary of string, string?", "query": "title: In Resource provider, what is the type I should declare for an object or dictionary of string, string?\n\nquestion: In Resource provider, what is the type I should declare for an object or dictionary of string, string?\nI initially use\n{}, but type spec asks for model.\nHowever, I do not have model, so I want to use a dictionary of string, string\nmetadata?: Record<string, string>; is not correct either.\nWhat I should use?", "ground_truth": "For a property in a TypeSpec ARM resource provider model that represents a dictionary (object) mapping strings to strings, you should use the built-in `Record<string>` type.\nFor example:\n```\nmodel MyResourceProperties {\nmetadata?: Record<string>;\n}\n```\nThis models a property (`metadata`) that is an object/dictionary where all keys and values are strings, equivalent to `{ [key: string]: string }` in TypeScript or `Dictionary<string, string>` in .NET.\nYou should not use `{}` (empty model) or just `Record` (without specifying the value type) as these are either incomplete or invalid in TypeSpec. The correct, type-safe way is `Record<string>`, which will be emitted to OpenAPI/Swagger as an `object` with `additionalProperties: { type: \"string\" }`.\nIf your API spec review asks for a 'model', you can define a named type:\n```\nmodel MetadataModel is Record<string>;\nmodel MyResourceProperties {\nmetadata?: MetadataModel;\n}\n```\nBut `Record<string>` is the canonical, recommended approach for a string-to-string dictionary in TypeSpec ARM resource definitions.\nNote: While this is technically correct, ARM guidelines recommend against unbounded dictionary/object types unless absolutely necessary, as they can limit Azure Policy and ARG capabilities. Use with care, and document any supported/expected keys in your @doc comments if possible.", "expected_knowledges": [{"title": "3. Defining the Resources", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-resource-manager/step02"}, {"title": "Built-in types", "link": "https://typespec.io/docs/language-basics/built-in-types"}, {"title": "TypeSpec for OpenAPI Developers", "link": "https://typespec.io/docs/getting-started/typespec-for-openapi-dev"}, {"title": "Exclude property from list that is in create/update/get", "link": ""}, {"title": "ARM Resource Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/resource-type"}, {"title": "Exclude property from list that is in create/update/get", "link": ""}, {"title": "fix error type for `Operations` interface", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "What is TypeSpec?", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-typespec"}, {"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "Record<Element> type", "link": ""}, {"title": "Getting Started with TypeSpec For REST APIs", "link": "https://typespec.io/docs/getting-started/getting-started-rest/01-setup-basic-syntax"}, {"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "What is TypeSpec?", "link": "https://azure.github.io/typespec-azure/docs/typespec-getting-started"}, {"title": "ARM Resource Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/resource-type"}, {"title": "Guideline for Client Emitter", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/guideline"}, {"title": "Type Relations", "link": "https://typespec.io/docs/language-basics/type-relations"}, {"title": "Record<Element> type", "link": ""}, {"title": "Generated Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "no-empty-model", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/rules/no-empty-model"}, {"title": "Generated Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "TypeSpec", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}], "expected_references": [{"title": "Record<Element> type", "link": ""}, {"title": "ARM Resource Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/resource-type"}, {"title": "Generated Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/08types"}, {"title": "no-empty-model", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/rules/no-empty-model"}]}
{"testcase": "ArmResourceActionSync how to get x-ms-pageable ?", "query": "title: ArmResourceActionSync how to get x-ms-pageable ?\n\nquestion: Hi we have this action to list related resources. We are getting [XmsPageableForListCalls](https://github.com/Azure/azure-openapi-validator/blob/main/docs/xms-pageable-for-list-calls.md)  lintDiff finding since it is missing the x-ms-pageable in the operation, however the nextLink is emitted in the response model.\n```\nmodel ElasticSnapshotPolicyVolumeList is Azure.Core.Page<ElasticVolume>;\n/**\n* Get elastic volumes associated with elastic snapshot policy\n*/\n@get\n@action(\"elasticvolumes\")\n@added(Versions.v2025_09_01_preview)\nlistVolumes is ArmResourceActionSync<\nElasticSnapshotPolicy,\nvoid,\nElasticSnapshotPolicyVolumeList\n>;\n}\n```\nHow can we get this to have\n```\n\"x-ms-pageable\": {\n\"nextLinkName\": \"nextLink\"\n}\n```\nIn the operation ?", "ground_truth": "To add the `x-ms-pageable` extension (with `nextLinkName: \"nextLink\"`) to your TypeSpec operation, you should use the `@list` decorator on your operation. This will ensure that the generated OpenAPI/Swagger includes the correct `x-ms-pageable` extension, as required by Azure ARM and API guidelines.\nHere's how you should modify your TypeSpec:\n```\n@list\n@get\n@action(\"elasticvolumes\")\nlistVolumes is ArmResourceActionSync<\nElasticSnapshotPolicy,\nvoid,\nElasticSnapshotPolicyVolumeList\n>;\nmodel ElasticSnapshotPolicyVolumeList is Azure.Core.Page<ElasticSnapshotPolicyVolume>;\n```\nThe `@list` decorator is what triggers the addition of `x-ms-pageable` in the generated OpenAPI.\nYour model should use the standard ARM paging model, which is `Azure.Core.Page<T>`. This will ensure you have the required `value` and `nextLink` properties, and that `nextLink` is correctly annotated.\nAfter adding `@list`, the generated Swagger/OpenAPI will include:\n```\n\"x-ms-pageable\": {\n\"nextLinkName\": \"nextLink\"\n}\n```\nIf you have a custom response model, make sure it uses the `@pageItems` and `@nextLink` decorators:\n```\nmodel ElasticSnapshotPolicyVolumeList {\n@pageItems\nvalue: ElasticSnapshotPolicyVolume[];\n@nextLink\nnextLink?: string;\n}\n```\nSummary:\nAdd `@list` to your operation.\nUse the ARM paging model or annotate your custom model with `@pageItems` and `@nextLink`.\nNo need to manually add the `x-ms-pageable` extension via `@extension`—the emitter handles this for you when `@list` is present.\nThis approach is fully compliant with Azure API guidelines and will resolve your `XmsPageableForListCalls` lintDiff finding.", "expected_knowledges": [{"title": "Same response model is used both in pageable operation and non-pageable operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "missing `x-ms-pageable` for paging operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Same response model is used both in pageable operation and non-pageable operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Paging Operations", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/05pagingoperations"}, {"title": "TypeSpec ARM Interface Mapping to Swagger Documentation", "link": ""}, {"title": "TypeSpec ARM Model Mapping to Swagger Documentation", "link": ""}, {"title": "Pagination #", "link": "https://github.com/cloud-and-ai-microsoft/resource-provider-contract/blob/master/v1.0/pagination.md"}, {"title": "TypeSpec Azure.ResourceManager.Foundations Models Mapping to Swagger Documentation", "link": ""}, {"title": "Get Resource #", "link": "https://github.com/cloud-and-ai-microsoft/resource-provider-contract/blob/master/v1.0/get-resource.md"}, {"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "OpenAPI v3 emitter", "link": "https://typespec.io/docs/emitters/openapi3/openapi"}, {"title": "Paging Operations", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/05pagingoperations"}, {"title": "TypeSpec", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-LintDiff"}, {"title": "Pagination #", "link": "https://github.com/cloud-and-ai-microsoft/resource-provider-contract/blob/master/v1.0/pagination.md"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Pagination", "link": "https://typespec.io/docs/standard-library/pagination"}, {"title": "Paging Operations", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/05pagingoperations"}, {"title": "Considerations for Service Design", "link": "https://github.com/microsoft/api-guidelines/blob/vNext/azure/ConsiderationsForServiceDesign.md"}, {"title": "Microsoft Azure REST API Guidelines", "link": "https://github.com/microsoft/api-guidelines/blob/vNext/azure/Guidelines.md"}, {"title": "Resolving Pipeline Failures", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/pipeline"}, {"title": "TypeSpec Azure.ResourceManager.Foundations Models Mapping to Swagger Documentation", "link": ""}, {"title": "TypeSpec ARM Interface Mapping to Swagger Documentation", "link": ""}, {"title": "pageItems", "link": ""}, {"title": "Decorators", "link": "https://typespec.io/docs/libraries/openapi/reference/decorators"}, {"title": "Support for pagination", "link": ""}, {"title": "missing `x-ms-pageable` for paging operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "TypeSpec ARM Operation Mapping to Swagger Documentation", "link": ""}], "expected_references": [{"title": "missing `x-ms-pageable` for paging operation", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Paging Operations", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/05pagingoperations"}, {"title": "TypeSpec ARM Operation Mapping to Swagger Documentation", "link": ""}]}
{"testcase": "Should I add a visibilityFilter to a model", "query": "title: Should I add a visibilityFilter to a model\n\nquestion: Should I add a visibilityFilter to a model so that all properties are only visible on Read when the model is only being used as a return result of an operation, or is that implicit?", "ground_truth": "ou do not need to explicitly add a visibilityFilter or use @withVisibility(Lifecycle.Read) if your model is only used as the return result of an operation. TypeSpec's HTTP library and standard emitters automatically apply Lifecycle.Read visibility to properties when a model is used as a return type. By default, properties are included in the response if they have Lifecycle.Read visibility, and all properties have all visibilities enabled unless you restrict them with @visibility.\nTherefore, unless you have properties with more restrictive visibilities, all properties will be included in the response by default. If you want to limit which properties are returned, you should annotate those properties with @visibility(Lifecycle.Read) or other appropriate modifiers, but you do not need to explicitly use a visibilityFilter just because a model is a response type.\nIf you use the built-in Lifecycle visibility model as intended, the behavior you expect is implicit and handled automatically for response models.", "expected_knowledges": [{"title": "Visibility", "link": "https://typespec.io/docs/language-basics/visibility"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Decorators", "link": "https://typespec.io/docs/language-basics/decorators"}, {"title": "Built-in Data types", "link": "https://typespec.io/docs/standard-library/built-in-data-types"}, {"title": "Built-in Data types", "link": "https://typespec.io/docs/standard-library/built-in-data-types"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Visibility", "link": "https://typespec.io/docs/language-basics/visibility"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "3. Defining your first resource", "link": "https://azure.github.io/typespec-azure/docs/getstarted/azure-core/step03"}, {"title": "Understanding the OpenAPI Changes", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/mustread"}, {"title": "Built-in Data types", "link": "https://typespec.io/docs/standard-library/built-in-data-types"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Versioning", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/versioning"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Readonly on model", "link": ""}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Built-in Data types", "link": "https://typespec.io/docs/standard-library/built-in-data-types"}, {"title": "Visibility", "link": "https://typespec.io/docs/language-basics/visibility"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "missing readonly property for page response value", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Operations", "link": "https://typespec.io/docs/libraries/http/operations"}, {"title": "Built-in Data types", "link": "https://typespec.io/docs/standard-library/built-in-data-types"}, {"title": "how to set readOnly for union", "link": ""}, {"title": "Question regarding the unexpected readonly, and customize the enum name", "link": ""}, {"title": "How to properly set read-only property?", "link": ""}, {"title": "Resolving OpenAPI Breaking Change Violations", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}], "expected_references": [{"title": "Visibility", "link": "https://typespec.io/docs/language-basics/visibility"}, {"title": "Built-in Decorators", "link": "https://typespec.io/docs/standard-library/built-in-decorators"}, {"title": "Built-in Data types", "link": "https://typespec.io/docs/standard-library/built-in-data-types"}]}
{"testcase": "Model validations are failing although am referring from common-types", "query": "title: Model validations are failing although am referring from common-types\n\nquestion: 1.I have reused the model Private endpoint connection resource from the commonTypes/v5. However the model validation is failing. In example PrivateEndpointConnections_ListByCodeSigningAccount, its giving the below errors. In the PrivateEndpointConnection tsp file, I have kept the resource name as is and havent renamed, would this cause any issue? Would there be any problem while updating it from Rpaas? Have observed some RPs have leveraged from commonTypes but renamed as PrivateEndpointConnectionResource in their tsp file.\n2.Avocado error: I have removed an API revokeCertificate and added a new api revokeCertificates which takes an array.\nHow do I fix both errors?\n[Added private endpoint connection, bulk revocation and c2pa certificate type by amritas · Pull Requ…](https://github.com/Azure/azure-rest-api-specs-pr/pull/24553)\nModel validation Error - Additional properties not allowed: groupIds, privateLinkServiceConnectionState,privateEndpoint,provisioningState\nPEC contract -\n```\nnamespace Microsoft.CodeSigning;\n@doc(\"Private endpoint connection resource.\")\n@added(Versions.v2025_09_15_preview)\n@parentResource(CodeSigningAccount)\nmodel PrivateEndpointConnection\nis ProxyResource<PrivateEndpointConnectionProperties> {\n...PrivateEndpointConnectionParameter;\n}\n@added(Versions.v2025_09_15_preview)\n@armResourceOperations(PrivateEndpointConnection)\ninterface PrivateEndpointConnections {\n/** Get a specific private connection */\nget is ArmResourceRead<PrivateEndpointConnection>;\n/** Create a Private endpoint connection */\ncreate is ArmResourceCreateOrReplaceAsync<PrivateEndpointConnection>;\n/** Delete the private endpoint connection */\ndelete is ArmResourceDeleteWithoutOkAsync<PrivateEndpointConnection>;\n/** List private endpoint connections on the given resource */\nlist is ArmResourceListByParent<PrivateEndpointConnection>;\n}\n@added(Versions.v2025_09_15_preview)\n@parentResource(CodeSigningAccount)\nmodel PrivateLink is ProxyResource<PrivateLinkResourceProperties> {\n...PrivateLinkResourceParameter;\n}\n```\nupdated the operationId and it worked. Let me know if the PrivateEndpointConnection should be a customized name or can retain same name as in commonTypes?\nWould this be guided by the reviewer?", "ground_truth": "Looking at your PR, it seems that the avocado error is the only remaining one - this is just reporting that you have removed an API.  If you do not need to continue supporting the older preview, you might consider removing it,  otherwise, this is an error you can safely suppress (https://aka.ms/ci-fix is a great link to remember, as it has links to all kinds of useful info about ci errors, including a link to the suppression guides).\nFor PrivateEndpointConnections, RPs have done both, as the name of the private endpoint connection type doesn't really matter to the API, however, there is a new template that greatly simplifies adding private endpoint connection operations to any resourc,e see:\n[typespec-azure/packages/samples/specs/resource-manager/resource-types/private-endpoints/private-end…](https://github.com/Azure/typespec-azure/blob/main/packages/samples/specs/resource-manager/resource-types/private-endpoints/private-endpoints.tsp#L69-L94)\n```\nmodel PrivateEndpointConnection is PrivateEndpointConnectionResource;\nalias PrivateEndpointOperations = PrivateEndpoints<PrivateEndpointConnection>;\n@armResourceOperations\ninterface Employees {\nget is ArmResourceRead<Employee>;\ncreateOrUpdate is ArmResourceCreateOrReplaceAsync<Employee>;\nupdate is ArmCustomPatchSync<\nEmployee,\nAzure.ResourceManager.Foundations.ResourceUpdateModel<Employee, EmployeeProperties>\n>;\ndelete is ArmResourceDeleteSync<Employee>;\nlistByResourceGroup is ArmResourceListByParent<Employee>;\nlistBySubscription is ArmListBySubscription<Employee>;\n/** A sample resource action that move employee to different location */\nmove is ArmResourceActionSync<Employee, MoveRequest, MoveResponse>;\n/** A sample HEAD operation to check resource existence */\ncheckExistence is ArmResourceCheckExistence<Employee>;\ngetPrivateEndpointConnection is PrivateEndpointOperations.Read<Employee>;\ncreateOrUpdatePrivateEndpointConnection is PrivateEndpointOperations.CreateOrUpdateAsync<Employee>;\nupdatePrivateEndpointConnection is PrivateEndpointOperations.CustomPatchAsync<Employee>;\ndeletePrivateEndpointConnection is PrivateEndpointOperations.DeleteAsync<Employee>;\nlistPrivateEndpointConnections is PrivateEndpointOperations.ListByParent<Employee>;\n}\n```\nSee here for the Avocado error.  We need to find a better way to handle intentionally removed APIs in Avocado.\nhttps://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado#known-issues", "expected_knowledges": [{"title": "Swagger LintDiff validation for certain models", "link": ""}, {"title": "Swagger LintDiff validation for certain models", "link": ""}, {"title": "Swagger LintDiff validation for certain models", "link": ""}, {"title": "Resolving Pipeline Failures", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/pipeline"}, {"title": "Diagnostics", "link": "https://typespec.io/docs/emitters/openapi3/diagnostics"}, {"title": "Known Issues", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado"}, {"title": "Azure Versioning and Breaking Changes Policy V1.3.2", "link": ""}, {"title": "After migration - in data-plane/DynamicSessions/tspconfig.yaml", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Resolving-Folder-Migration-Conflicts:-A-Guide-for-PR-Authors"}, {"title": "Resolving OpenAPI Breaking Change Violations", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/breakingchange"}, {"title": "Decorators", "link": "https://azure.github.io/typespec-azure/docs/libraries/typespec-client-generator-core/reference/decorators"}, {"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "Checks", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/_Sidebar"}, {"title": "ARM Rules, TypeSpec Linting, and Suppression", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/arm-rules"}, {"title": "Renaming Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/generate-client-libraries/09renaming"}, {"title": "Handling Errors", "link": "https://typespec.io/docs/getting-started/getting-started-rest/03-handling-errors"}, {"title": "Use tools to create and validate Azure REST APIs specs", "link": "https://eng.ms/docs/products/azure-developer-experience/design/api-specs/api-tooling"}, {"title": "", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/API-Spec-Review-FAQ"}, {"title": "Running Locally", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/TypeSpec-Validation"}, {"title": "Need advice on how to change operation parameters on a breaking change", "link": ""}, {"title": "Avocado error after @renamedFrom on custom action route", "link": ""}, {"title": "TypeSpec Azure.ResourceManager.Private.PrivateEndpoints Operations Mapping to Swagger Documentation", "link": ""}, {"title": "ARM Resource Types", "link": "https://azure.github.io/typespec-azure/docs/howtos/arm/resource-type"}, {"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "Understanding the OpenAPI Changes", "link": "https://azure.github.io/typespec-azure/docs/migrate-swagger/faq/mustread"}, {"title": "TypeSpec Azure.ResourceManager.CommonTypes Models Mapping to Swagger Documentation", "link": ""}, {"title": "Interfaces and Operations", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/interfaces"}], "expected_references": [{"title": "Data types", "link": "https://azure.github.io/typespec-azure/docs/libraries/azure-resource-manager/reference/data-types"}, {"title": "TypeSpec Azure.ResourceManager.Private.PrivateEndpoints Operations Mapping to Swagger Documentation", "link": ""}, {"title": "Swagger LintDiff validation for certain models", "link": ""}, {"title": "Known Issues", "link": "https://github.com/Azure/azure-rest-api-specs/wiki/Swagger-Avocado"}]}
